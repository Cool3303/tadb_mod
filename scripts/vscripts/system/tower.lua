thtd_exp_table={200,500,900,1400,2000,2700,3500,4400,5400}
thtd_exp_star_table={1,2/3,1/3,1/5,1/15}
-- 总和5400
-- 经验分配规则 保底 1X每只30点 2X每只20点，3X每只10点，4X每只6点，5X每只3点
-- 单吃一个兵经验 300点 200点 100点 60点 30点
-- 经验获取率1X 100% 2X 2/3 3X 1/3 4X 1/5 5X 1/10 
-- 素材培养 （1000+素材卡牌经验/5）* 星级


towerNameList = table.fromstring(string.decode(table.concat({
	"33310DD3DB55B46E32D10E3D3357D8D48B49133765098764CDDBCDF8E601BF17F400AFC63EA176BB19D56411F9C074632F115C71E3B57EBF1AFB9C253D6A964EAFE328DF68209C28AA61A3478C664B26C328FB2655ACBC74D78BA6EB77C8621B07D89D13FA80610389A254B33CEC04DA9850809AE1A6BAF9AF2E16E9D807805",
    "B4F06E2262786AC565E9626C67A532EDF768B028CDE748B472EA2C8074294DBD35EC95BC3C0AB041ADAAC8E454E060D2E59733CDBBE827AFAE0F142DCD400FEE26C2D4446C415EDED53E777FA8097F66C8E1DBAE0AEE9D3A1C1827F03DE080116CBB622E46EA997FC75BEB5E048321439E1D5FDA425778EB9716362A45FD403",
    "2E9E8F9FBD00DC95988091224A16D8CADA20AD3CAC80EDBCCE507852697D55BAA3853FBBDE8FCFB4F08A6BE8B668089DF0EB4703BD2448A7DAC9F970012E7416A4F1D9F0BAC17977F5769505619FC096174D221ECE79291D7AEC45AFFEF67700C32970DA4782B71FC0AD7CBDF5E6A398C25FA3983FD99D720B591B61A6A9AB0",
    "4FA0E3CA214BE4F9B70716E48AC876B3F616846D77D51321B094419862B2D24E740BD57B215AAD515D47254F192A909178DDB7DDA88B00F30CFBD457A0120B50D54CFB9BD98B7CA781738463EE7D2C71983ACE7113307142FF391A3381DFB9B06A735D92DBC48FD52606C09D0E87A19DFB764BEC53DB46AFE541103D0AC8C65",
    "B93D02A91F4EA0B9CCF0C57A5DB48C587F4B5035E371340567D55490C3F9580D50DDDEA0312E92D4E8AA6BDD7EC1A6BEDB50BFC34ECE0AF9EBF43572055E7173068811CEAFE91B278FA0735B9E8126A873BF9ED19CD651862BE7865255A8061FF81952A43E06C34437F25775C8F4B5A7A06CEABBA81844EAD7D28602B07BF54",
    "88FD3879097D8F993746FD8E15151C1DD85AFB9D859D24FAAE30BC692BAD68B3BAB463E40B5CA352DE924342CFDE1082341EDC3FD8D9D03A7915E3BB1F8BE4A2C83C726D4409E888267F9F6259DCE345AFB534D415533D4E0EC69766DC0E29D09721427EE3E750F0AE59F2794C76638E8EAA34463BE9A9A49313FA6B3B1DEEC",
    "6E7C4F0440B38B4506D08F3350625782FED42329B27A7FF18AFC98868174BB7B02A5E3C142AFFB672850D2EEDCCE84E25A853E384067EDE9AF46431CB0503A41234658D8CB3B3389B1EF498F97AAD9E1EF607386B9EDCF957818CCAA1BE57F877B844DF2B0F4B1E80AE5DFC14E6AC3CB3A5AEE787A238115E4ED057004A1851",
    "FB834BEFFE83F5466311B48820663DE02875026E98B5EA091A7BCF60E7DC9F22020B7C5486FF376544DC2A7318E01FB0952582217CBA4B2B8B913B56906C247455BE97780AC404BB97020096B81B049A8E6D25F82F9075432F92BE33C4F74F8B29E95741018612B8CA116B67D8DD8195B8F25116616573DD06615B83CCFB56C",
    "93D0E24E8263A858D3B27689C78817C7EC67D01800082309349FB8934F20DDCF753D5B8BE25409C4E5B8F6EC9854D0137EBCEF69078BAE35B72C129063B1134BE9BE66E747F13CD5AB544F795753304208439FAE230986D17F174782467C9FD717F89FE1C7D356C174FA1D02737BA0148AAADE3A0CE5F9AD8ED6FA6F5F0F1AC",
    "88401D13B5016A1B430E47EFBB571B0EFBE2377140B83E9973FE4543AFA754012074CAAA03ED0AA854A33624915E95B19409531FF0BBF3D23270C4CA1F7076BBFA9C8C15A1C32D50372124C7B57C7F56A3BA6A06273EF9D8574B68B5183F6B5AD93975C269E92BFB8AD74735CDD14557C3A8F4267D065DB5D67A2AC6C7AD1E0",
    "C455B83584485B47182BBA3BE4233EF6F1302194FEC94E78A0CF943D67CBAC9453D4973013E86E920136E1756451C78D4CD413CF9FC9D45D425D3AD41B47E43A2382BDD211C0E029CEAF350FF2698B3AABEF34E2DF3C1FB5CCF5EF6956BB93AABFA98FEB68D1DBD9C479132285504ED5858D3816C0BDD01BFEFB134BD2CAFDF",
    "66FCDB983343ED72FE8220B933562DBC381C6146D7FE330044B682B158945A842937361F639D79EE2E23CAD3F0077521CDDA44804199BE213D2BF90CE35FEC5565E75C1ADF210234F550139A757B169F63EDEC97EDE9A7E80A229BB9180F3D497B43380E86F246E0F37E23292F67B3B2D6C75A17438E5015766BCE1EBB8783A",
    "562754CC9B2F3AC3179D5EE10A308A702FD22934BC4111EDABD25C89DC25603176AB0CD53E46C114294E7807592D5AC7B6AC3843EB60E9E5BF66507CBB079EB493EE1CFC504E049EF93A794B7FBA3A28853D584453A9EF5CBEBE717A1072D4DECA6A6E6919FF7A5D78BFB2646AD250A060E5A45EA955E93FE49A338A8858349",
    "C33791BDEA820743A9038FBCD4D2765E7B174C1F103AB7F2699EFEF3CAE8B795E51C835FB1823D23E84185D3712F5BFD786D940E0F838EADC7521702CE7BFB9394CB26DFF4268DCFDA8FB3551A9527AF066299B4B1C10050E3EC9D137268A54D1F8A9BB9DCEB1A5C053482F49988F56F88EFA1DFEC7367A88CBDA4EF67BE1A2",
    "D49F9116789A3B317E66E4E9D0E06DA62134A58F6083C62547C29187AEB1199B160B65DBFA504F58AD2344F6AC90523BE2A21FD6383B6C37BB9CA0F0DE52318B24D47B8C3D4B3D02032FCE27A33D80480302B828CC8B5D3DF918FED7CCBA31D14743B4FB497717AE8F7AD854DDC9F6D1913372E60320A40F44CD15D83CDCC6F",
    "C1C63020B3515959DD7F9B53F961BF6A4E4ED1600CAF23BB2258D88D5AAC67211E714A212F976558960F2A8C67D19316D425ABB3C924914606F97E8173E896BE262BD3A61C4D9129915E6220EA41789F149BCF2C520A6F629C0A4FBAD8AD604D7BA8CE9A5D64132449A7A49356122DABADF44743FDF1F01BDE8EEBB416F5E71",
    "13CA10AD3D717F53FAE35ABDE91B5715506B64A58FEE5BD6E56783BF905423758151ACDE86E2944DDA6E9AAF21A532C15F15094B8EE4C388E10AA5467BD5327DC99A3E66759B1C7C7D505B96757F225BEFA7270B9EA7EAFB69A1C94C6D6948BAD5A38DBA982BA7111767A6CBE817B52FBF3CCC850753D637D05844AB256231F",
    "9359047BC8D84D2F4C5E76631AD4D1AE62CECA68BEF62F1B06B69212106D7F4CF72878B1354EC2E5ACE479F45E082DE559F363A014FBE82C3A948DB7DD269954BC7F2C1DB709052C042C3250064585A271E7F6C181421E52FA5196BFF482CC19FEE00F85AF2149BCC26BBC2EB5F04879D80BAD457CCE63B428973329CB55E00",
    "C458C113DF33F789C8DC1E83901514E2DA0FEE6FF41DD4B6F8D63F1F8B29A7DAA0F9C126FE6ED3A571BA4080AF4B8016614363B060FD6D990BF4B2415CF2FD035A4E9EA49E74B213DB1AF5367F576722E34F1A1E64B6D23BA761D8FAAA480C0207BE5E93BBC3FA128D2BDD5091D3CE3C192ECB34D09FA0AA50723F129726B4F",
    "685E2F0C7A92F04232ACD781C535E07AE996C3B869998321959F2465098D3D0FC0E409A1DA7146DF87ED29577DC3348D0DA2D417EE6854AE6E9602403E1A6DAAAFE9E4F8D6B1EEBFBB19743367ECFDFA5A69EDEC823A4A65280DACB3907C9C9D32B618A110FB52B9B3011F035E8C0C30D7257E4FFE0225C7CB4DD7FB5BD22D9",
    "7010BC2C2594E6EB5AEE7C9127817248C856FE4CB661903C4855CCE73BCE38482AC867B07CD7C928998F5DEC70F8B449AFE637DAA94E51184786426ED6749F82A7950F37E3D69A25FA6C502D07983B17B0256D5BCD04BA41B2DB1E45AF538E79062507A1255E67C43FECA1052CDC1C317DE0891537543F45A83DBFFB6E21745",
    "B52FE8DD382BCD9ED96F85EE6AF4BAABF465A37250336EBCB830263182C9E8061D17630FC31368BA41B1E1EC4AE616EBE7EC954B3575F8CA221D63F3BE7770DA02E434DAA3065DE6E1F5B07B920F6505F31B6D463828F9A512DB3B2CF4238EC1D8B9B7AC08E2ED81A365E8B0C0A6A74EEF4CBF6BE86326D00471E0A263AC978",
    "34040DB6275774E3483D5CA8DF7955F9C25B814208927725DAE851C7EEF9E9035BD2B88E0C6E831DCF456B9AC7E77869BF0CD38746CE64495B86DC7C9F8F97056204274936989580C443C18E264B18365AFB9598C4035F5C576A6C25B00879530AE11BC1419145C98984DD661F7D3136FEAFF26289A3A037718FF66046E8DCC",
    "87C102588EDA944297D5CAB1853EF3C2C4E140F37DFE5E2FDDBE6D6F9DEC5CC21C353FB894DD8F7E84ECD5D20609F4AE92F6324FFFCD42D6F61887A20DACC1253532FEB53E57F3C5D63E21D673E3DFAAD8A8A9DD63DB404EDE4188C50AD9E2E47D356E6990F259583502A6A24DA08E539B3F78E7498CFAF2267248F248211D3",
    "BF4F9CAFF7CD923F2AD9054E97466A1528358F34EB54A2B8EA66453AC15383C14177705BDCBEEA25F0D3BA23A666FE86AF02A4CA20562DAD0B1AF977C5D8EDF71746444CC03C995E8B2EB000C2215959DA6B33C40680CF8030B9161852B804DC6E089237F3723D667D5702067237CB0E07243000E57A556798E29E865BF0418",
    "FCE4A0F814B1B1CB80503671D8F78B25144EB643ED96FA653DB7832623C00D0699156C8D4572C7941843B5153F006CE24EFB8B37A2DB3CEEBF90399FC226CA11B4B5DCD9366138C9F55802C82A198D1B025E859F879C76AC6E656E26EF4AD86A1626728D84E79663A2C5EE399C385F05F988F080C87F37051D85A10B52D3226",
    "3B6AFA56DC326D2BA32E8F09B671B25E557256098CFCB8C1801C21548E8448EBF0DA8B035B0C2C1241CEA50EB25D480329B1A2D7B317063BF53E98DC16427716E0E0CAA638320F9C9AE93EB78CA11C928F0DBA0B74BC3C0946FC498D5F9AD00F5F55A679C70F75927D87EDE8C4E929BDA59812566A8DA99106D042E8323329C",
    "42E4EA3818ED036199F2B9A78ED6C1480C135950DDA1C8CC033D567397FC5FCD651DDF9BAD7FFD22AD854A9B65152A01047237B826B1E77293ACA196E8F2960A17E396E45CB22ABE1BDBA19731C8F743929E699AC604A75B59F943B6E9B32DC23DC3738E2B911315673F99AEEF56F8C1036F7E420867A3DCF2130125CCF8474",
    "BC76080574E0F171C8200870B8033C94C7551790E558E445D8788B3E16264161D949CD13D586114E3F76E19245DC917CAAF65B03C1A72B5F1481609322C94A2D05290C36A551BA98ADFA3B44BA58555E3736B341E3459184C3C286292ADC7EE533A6109F42AE2B5AD1C8CF0E520479DC264687DDC83F066BD0EC5CAF616E7EB",
    "4C215E13A8C95A22A7E185353CB3E840FF0D2D5C5EF1EE2CC6CCFC21FE3BCD9D2F2C41D61F40174E81F360AA5637B277D9F348D7F80176FAB7A490C0ACC821BF17C0137FDD0D8343AEC2B5C5D67CAE7BE083D045D24735E260BF93FABEE6A70E7A520AD49DEB8B1F74F037D210043180B368533037FC81742E027C0C2A9F07A",
    "EFD339FFFF4E723E8BFBE1EA327C5E9012BAA5CFD282CA06F28184D903348BA6BDE02D17348CB54CB86CB96EBB4B42CFF428C431D034DF315CDEB642396D610469CE9A2DAD02AF3A70F31729DD195FAFFF01EE0E7EC56034DDA772205EC45A0F49A1A9C456DE107263C511A94BFBF9F6252CE43FDB4AC16696014BC054F9B8A",
    "BDBA8E4F4E18BED5A1DF866CAA0C1E5B3C38A762E4D3507FEDC32EB04471891CB8BA91947C072CFE5DCCD37DD074876BB249267323715E986EEB4AC007DAF3F58AE493B7B4E8D050E4AF25468FAA47B9E63191DB6BFB9C94F51EB2A3318B7B1929F65CC3A050F57C4C62795E88CFB3F3C21865D2C9A73BC868B3AD5674D0119",
    "2E5B748056136ABA4FDEE515FE5F810BFD532654347E24AE87C8EF8489745560573AE08DE911234BA31FE0C773A6E8B19BBE22134A6E85A37F4F1AB7C687DD18714EA7B5C6E2B195017A15490ECA5B5DABDF0F77E0E9908C4DCCBCC1D765E1BE8D4F6E300DDDA728C7D86AF2355748FE1D2C33DDD61663FF315B6A5A5660D79",
    "965B83BFA2679E5B4DDBC92F8E9DAD97BA4C336873F0169B3DEBA1FD22074781E1440751A846745EBDDE2144874675C8902072C66B02E6D6E873EB06C02073A6D48C2FD8AE3034CBD008755032240C2D9123B759CEF59DF9F896EF025C969C9CAC9BB34A911ADFE5EB1A90B5DC0EBE296F55F3AC730D8AC3A424BE74FCCAB74",
    "56C1049F1D2EF1AB6CB0B624D5E5E143C43F3C9D86D31E9AF53EBB18A4963E67CFC57A619E7D3CC9694E488A5E4B3E48A1377FBBCA682E16FB7C45F627AD09D9D959C7A741D6764D0420A165EE7C7B89D5E946F712D936D2B6AA22421F1CE20843CBA97B98BE5F7F7E4CEF3028D48D0B4659BC89CBBF67120BCFAFD3A81B3A5",
    "9686155364A9502F5C61C6E5FD88A82398DE1FEFA23C39F782D585176EA27BFAAB8546CF8E133EC9C5B7F80D4438C86A00561F33D8F20987D058E30F403545780D2067A888341344CB2A97EF7125C49080068E6BB034E57B17C1DFB360421FDC6521EA72E6F417B75C313F1283115E89328BF7630FD43C1EB63443F12C598F3",
    "61DF6FF748755030DA3E5259430E1A44523D5ED0A53BEBF5EA8A4AFB56F4427D78C6D3CF3E5D0E4823F03649B65EB581095A6354FEAF49EBC5838A6ABEC12BFB783B5E0C86AD1DCD984D35DE809D9F7E469CEE26E96CF9A489E5A008D93B75EA1D4D0BC894CDF08967FCEF6B37541420CD427C7C064B9E2913FB5B4BAC3416A",
    "1237DD0B7931657D3D44E5FA6E0A520AE5EE47AC13BF5DE81D9536C576C1821AF41AB811FF28195E731F2B54C027DCBADCAB49981393D81D8771723A905A9F53687D48BA8D7109ED0E55569727E7F7EAD584DB286E0603AF5E013B77A4AEB94F35625330370A8B94B0F54643B762BD94C5B6EE56382771E2D1FE5626F7876E2",
    "18DE79AA6D4F253D5A9065500F4038DD4A6DBA91602AB85CE2ECA08F957BA9939B6A54E989EF570C8DD24995A7AFCB4DC09D1434CD6A6FEE59D82CBE65F15A8B10E8AEDEAF956019E3E6103D3557BE2C5CD7B10AC3CE3006F42F7B72898DB5BF3341C68B6AFDCC922F888EFCD50AE9201D50948495E45570D7F387CD8DB5BFE",
    "FB5A35D47C871597239627ADDE55FF9EB39E59F8F930B02F17D49222DDEA53D483625D4A2FEB707585A20A8D4FEA7C86C1FEC25F1892F735D28993F32599DB8D966F5B162D4BB4AA47B36548CFD80DC43724A981684FFA73E94B1C4A19C367BA896EE472E664B54631B4837A99A6D2F5DB33E9F58B1FB0A10945A2BBFC3D4C8",
    "4D706207A0C099807CA973FB21F84D8C55C36C3DF38D6EECDBE4EF53C4FCFFD39BBBCCC7B04D306D98EE097470B5DEE4079ABC2E8BA356FF774F6944BAD99ED0234CC75ECA2987A03DD8C71F42743476CD347E14A0E6B28E0C1380E4B8136CA3149854AF7ECFF2EB548E9416F11024D957686E94D3E8C3987F180DB05C85D2D",
    "B135037AD1540215662ACBBD23E52698E11FD7F50796FB4BB2397683E493AC303462CC4944DBB61D9BA478CE6852A20AEF4C2BCB19AC5418306E743553735F8E6B1667B77369A7B98743778532A848B1804E82793AE827F421E4BDDE8AAEF23A07E34904B4829FCE0EDFD3F57D95EC10B1F1DB47E17467C2B536F8D9E9FF5B6",
    "B35848DE278CEF4ABD20D42B4CA5C0AA81C430C6FCF27CF5034E1218639E2F6E3CE4F53E5C2ADADF898EAA692C2D990B380A7D490729E62B909BE4F0300F9930A324F9D0FF02933826CD8152204E464DBC89C6C51D33321497D6A63DC7E788F4CD51543A1C3CE646393DA72FEF569DBA694D58DE44C3230774DB4FB45118DAE",
    "21AF84BB36AEC3EAAC382D700330D7565850B96299906C10559F2EACA5689BAAE71E360D1CAE4028C640FF3ABD7C0A4FEDA02A925AB0E43FDF70FEF0B6D52903C405BD99E78C4B73198CD5FA84748013AEE73034BFBD7F11B45E23A4D6ADCD545C3B52C9B1E0CA677EF444EA38FFB9EE0AA123FED4894BBA1A6DE1C839EF093",
    "9CDEF6F143C84B8720BD77CB309464C0C61CDA9113D49D8A9E46D417749884DFBCF27368A7F5751F8ADD00B4D9142AEA939C0B7AE7A36B6C0DD2C6A6ED3DDF619B538ACF6B84774D6B53E07C6237D41D9129D63E8367FECF99488E8383572F3BA58F97C67A2FBAACF27E05A2EE5FE64E42DF9D42A14947EFE8811AA86E634D5",
    "B4DF24BA29BA62ACDB7BC4BD8A5A71F521F10FA5F2C3BD0314578391369C3C04569F502610E0F49D7211C2033293C0C775FDFD3C41F1DBE3127DA72A8F605C3E9DEBFF652788A9283088CD6BEC537EA7AD9672F6EAEC076F595A7A426068748F2116652A11283F5C332E3B1C6A282F75CB676612C2E6E37A5DC9AB108DFCFF1",
    "0539CB369FC8EE42EDE76F02DDC847F70990EE848CE427A660CB4F3FDA67C58ABDE13B38DCC8CF2AFCEADF2998AF2D3C5DD8221261E7AEA865EB4D604EB166163B523260820402F84ABC5E6F6B5B61276C770DB355A0CB1536A36F838E936E584A86AD936E2DF510C8E5E78461F3ABD98635C29F9E17410E7E7C51430AE2E99",
    "D195DF1EB820F2C85688E039773954EFB60C8E4F2883A57E52FFA8C51FF6D80C15CE967F7F278BB0520AD0B5BC6DFDFD862625ED47AE08530266AAAAED419E2B177D708424FFDF38759866767A9C429925E93D9966BEF52CF706136168C3F31D4D16D1E4F82D436F9AE476D1F9E530AC65AB3D2412CBDBE95CFC5C26FCC546E",
    "A46ED7F0766056525F442676137FA9A7D746EFC53CC5F9594FD461F4ACAA4B1F48CA16533A5212A6DF20917A337BE2FC271C2523C3ACBDB3A7A53CCEF7F551C2E685F5F8A42321D9A892754564210DDD5B97E327AD3013952AE627AEC02B08D31AE51ADB64B662A36E3C3FCB20D92283C28B9243701D965A8B357923264726D",
    "170A91B199C2187FAD97D9E2AFA676EA43343972C02208A3FDCAC478C0DE0DDB2E2E12D235BCD2FBC80126D70E99941E9450FAC18054351BD38D06DA1E7081BFB9C1A4841188590FB6CDA1A502C836AAB8A422DCCE49410760C27C2E56B84B0045FB271816C0ACA3BEF15A82604244B16E32C929AF209BEF01787DFC6DC28F5",
    "4D421E09E89C0EBED96F58F6D8657040B7F44267F6EEA1FDF3636004925FC7172A94089BCFEDE05AB964536EBE797C8DCA9882F1C18AD3B411A0FCB8172B0AFB0065BD634661A2909982B003003DCAB6525FA4C4F0847246676977B7E2F7C498DD53560118C7912B460155535FB9A6F5E7B1D1F7B4CC543347328F6481F72B8",
    "E0A04096ADD36DBBC346D05C46AD0A98374F84400845F6CD10CFADE3A947B08D4CE7FE2D5134BC99F68672A01DA5B456E2DD1C2178BFBC085CB634F14C1663079E684A07E483D54B7429B742C241AD63074A5CAB0FAA5385525B5B6205BC8980402CD7BBCD94EA1CA3A2B000A0845EEF8BB168B434EC4FE85259FB5142F8D6B",
    "A42CC964C5027AE9A8979180F58DDB916242E5EA8FB969CDEF2BFD78E37B18F32019F6E4D6F52F23908377DA690FF370E814DB35F9B959508914658F6701F72EE27FACE7F3DDEC919553F395248F821AC37D721A93F2A7F83BBF860AE1E95D2FD361F705EC591045637D26F37E130720530CD6D6C478B9347BAC13D81603B0C",
    "C842A47CFBE0F503A562B664EDDBDB0A9DB48D68B86A68A36149AF5E1CD60E1D773F7C585C280315D2AFDFD7222D7AAF4E9E5B8E11690D2C6E354CC8BC4F3D1B2ABA0F1D5FCA7D2DCFCC4990214541916E541D6E2902A2FE618DB4E6E5EB2A0209794821271B3CA73F3AF0241F1E445D905D519825D7050710978A433BDB327",
    "BE53FB472DB12B9322BA1BB13478346B3BBAA1556FEB93D49A7A0BC012A172FB784D5AAACC9166B1C2FA0A6122414AD28BFB912E825EE1941D7324DC3CFF9C1DAD5F5A28D9EC212D34E8C0C7818DD13C8A381CE978777D0CA58AB32FBCF5AB45DD793EDC76FCDAF1D4336B11143B6AF801B5FAC007B8A94DB95225727C5C81C",
    "ECB92D34C69728214F346D2AC43A2CBE395AE2CC4CDB759A64BA55393BFDB4F37CAD326DFF624C26363BC7CA3EFA00CD959CF9EE2D9A1044F8739F5AB14E495A8364A22964C239CBE293BEE4D45268C962B2C97B9874A4504282C952BBC6B5DF17AF2DAE6997CD45DCC173021370CE4FF8953F9B9E128E79654DF5C48CA7E37",
    "02CB7681920657278588932B10A7AD8B1593A3DAB69E8D265E4020605E80181E1FC0578F52133055749773C1813F4B67567E7A9425D485838FF8DFA0E8AEB4ED94C001365C11A40DBEBDA49C076437571F144AA8E0F66C850EF0CE7FFFBD613E6B0AB1C0ED6EF53C6A261E1C09197EDE77A89CC2B87CFAE5E3925D550A71588",
    "B5D306657B3E262A51F936ECADF839AC03C93A2C74F3276BAAB6A882260FF4E48479AA7319403833A625DD3B9157B75A63838D68F8B6CCFB2C66AF2051DBC44C23E75B1794FDC089AF40D738C5B1B70B93C3D551D36C12118D5179AB6C04FC426D76A971F9BBFF8AF3F89D68BD65912884D6DAB79DBB830A89242B13111057D",
    "1FDDA43E30C7EE61349643BAE5CD464E87F916F6E256E95035B036A6394B6540A926E2168151E8A0125ED7633EED3C0F31015197129755C1C13E7D732CBAB69D10E053CA2616FA0DAF993E29A61A5803D1C0B2B17A4716868BC7C648E591365678F6138ECBA9EA0DB43CD015B5BEDD88B03A00645661F87E291BE52F0DFD09B",
    "7F02B11C736639DBE64A90329AE016DF913E72E7F67346D00225328C71C8C947012641FC2BB930AB8784EF5162DA619315D27D53C75D96B3A415E685D2EC72801146D3D10743E79378E7F56C176AAEFC38E47677FA46291C379333A300B840C43CFC77CF30F3A9BB32D6BA43F65999DB78F25F9754F88ED9C2A7AB88CEC8FFC",
    "FCF143817406CED9D33EDC732BEC8C394DE8D70766A5C8B02C86901F048B9FB0D339F0325ED9BABE77ACBCE4EDC857D302DA1F4671C4DDBA77DF19001B9CEAEE1CE2D010347D337AD5B07E74760B7A2E80A57788DCA0C1B6195EB4123DB1C8C8570165C90196DF96D07D2A4E773D5A1A1B5F5F248B2A6697D58720207575917",
    "0B3609A530A406AD330BB1257910123F0603CE6BB1DC837822F07DD2484989610EA4F001F7F5FCF14AAB46B92A168FB4F27348109A34FD2FA5C79A2FBA3E27EEA9DB813676418D590A3D5F2D028FC9A0753D1C128F56F8CBA89F505C054632EE7333965E6B49D32E430A418215FF667086F60691833E6780D25D1F25F953A6C",
    "55C2257D988BC91ECA6DA3423E1DFD9F712FA8210FB513AE30C56FE8D01BF3A1AAC3E8AFD060BDB4142610279890875141D8E13750FA611470CC34A8A159BD007A244DA588BDA2E618A3D152B80E6C790596C9E7D8708F54AD96C56E036BA3A84CF27187F6479D2E0BE8BBDF2C4CD185BF33CEF3A4F929C51A62198677E67E7",
    "9A4B7E178DBA56D038DADB226957417AAE6DD6DD56FD000F83EF25CD00E1F402E87F67D53764C1BB2FCC70B71F16974755C686DD5002DC1C075F7CBD64102445FC3159FB13D4778EDDDF5AAF853D3D6CBF9ADA8D34BC6F170110C7A7BCC7504CF8735F72C1FAE8B20FB18222B474CB078102428BB3C726B1608FAD981C749AE",
    "1E87EEDE6ADF5AA76CAE07F91C98856B8DFA192C14367A5C32146B466A0A029CFBDC4031E7BB90C34927B84BAB15BC557D6C53664BC435E16D5CBD28AF5ED1B4A4EB6EE3502000C6E98E3708B8DA60B267E5C1B9CAC8442964E04D0C9556CA1B225F948450AE235777B1CB26AA352E42929D3566E3AC71D4769643F3E495F66",
    "673350E625A98A13E463511CA99F6E270405C1367756EDDEE087FAE8D84D5B1504D3BC50C3E5BBB8F9AE33C68579EAD52E6E99C0A4939A4FB50ADFFF039E0769B2AB14BAD417EAD2399851EF53D01192152158ACA3E64E4DB79F2A6ED37534FD16E61A8AF5980D47531AB067FC67B489AC0BCC6FAB3C4B89BBB82A63FD5EB9D",
    "8C5B9DE82831B9C4DF746BADA3608EC283ACE5D15FCC5FBC26A321A629953EB29D70621D3134C830A19AF42DBBFEB45C1D0EECB4164F220DB01484832C9C4E0E07329E367D8C15448DAB28CFA0A2914EE1F7DF5158682F0BF29E6E01D1502B0371A81D646FCCC4D16330389D2E9C342AB6D6E9674F5CBDD08521260604B00CE",
    "3780FEED33B8417408FCF15D15FF1E58B2E4AAE9DD12F71B5F54D5CEAC4883E22092B8B6B603C377ED6A785522E8BD58EA9F1D9244CD11C18DB45B432305E04DAF7DAE9125133EC8AFFCA3F61C75C38571D492351B58BF2F3D8732EEBF11A473EF12348CCF8C95E3AB0A5296E07922CBA2131BCEBF090CD297C9B1870CC1028",
    "375481F7F376DB8192A0CBB8C8806EA4C897B20B3710194453714CC0E99507B4B7235A05C4323FCF06ADD0EF679FEDC0D6EC86FAF78417B9441E3BA7246281D90133B9C0A075E8BC886D9AAC3FDF4BB54B4B8888202ED09EBF69482A0A1F0F7C66EBDF3FE03FB9C032F9211E1CD4B1A56FFCEBC5332577547E097D46F617E07",
    "F17894D5215DFB5F80C0E76E22DC9B749504FF28AB6252EC2B616F14814DABFB848955046029C6D20549175C32AA6A7DCBED64641A37E124E6B5DFA4B1F87162C463934D5F2B95BF574A6B643BB6DF4301CEF2C6AAE594F81A3F257C7922E300735A6D04E69165FA2676FBB50E23ADCF3A3934D5B8ABA41B2D3614896C1A18F",
    "0F5EA04237B4850939A1E4CFDC26A2CA73C42C3CE5E3DD189545D7DE0A0933730DDBB830817F1A69907CD1CDC6E688A7CB30675C4117F39EB5A9268E6C746E99A80B24EEAA0E9FE3D6714C79BD666993C777A49FAE2DF18DE3C80CC2DA52205DE41155F530281E14F0FD9888089ACF12F0AA58FA68C8528F85CA9905DCB9AD3",
    "BE85D45AAAC5A99AE067901E934EDDD530F9397BEC092B9EE0DFCB49B9D028964ACAFC862DEFF3B8186D35B58AE2F7266E268A884CD8776011A5ABA7D1B0A7CA11F8319FBD6C4869A7852203EB091BF8020FB2A5A184E1F6FD9B53609938BB90DD3072C30E6EA50A4BF49A9AD2EFC68D66D7F2F98E6414001F173F50950B1DC",
    "B5200FE8868424760DB425C7F5E648F499F7E6327CDA871E734CF1D2F0B6921BBF2EF0E9C06A1721BC8454FE3F7F03DEAF1762F69857A366165EDDD41AEE464F5FCC54092C72C3E4E7917ECCC2B59A3817D58512F89B46ADA35D1A6305219D7B4EA9E62B30A82E7C2A87F08D07FFB3C17A850835494FE96D29C8BF7EA61EE9C",
    "92F80DC55B68007ABA6D61A61C7ADB9F0CA2A0682CE57195E85B147C6FD"
}), server_key))

towerPlayerList = {[1] = {}, [2] = {}, [3] = {},[4] = {}}

-- 这个表是每颗星增加多少属性
-- 前一位数据代表基础属性，后一位数据代表成长属性
thtd_power_table = 
{
	["lily"] = {
		[1] = {50,10},
		[2] = {150,10},
		[3] = {400,10},
		[4] = {1100,10},
		[5] = {4000,10},
	},
	["nazrin"] = {
		[1] = {20,2},
		[2] = {80,4},
		[3] = {200,8},
		[4] = {450,10},
		[5] = {2000,15},
	},
	["mugiyousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["shanghainingyou"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["hourainingyou"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["hanadayousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["maidyousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["cirno"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["kogasa"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["letty"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["lyrica"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["lunasa"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["merlin"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["rumia"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["satori"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},	
	["iku"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["mystia"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["marisa"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["tenshi"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["patchouli"] = {
		[1] = {30,3.0},
		[2] = {100,5.0},
		[3] = {250,6.5},
		[4] = {600,8.0},
		[5] = {2500,15},
	},
	["reisen"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["yuyuko"] = {
		[1] = {40,5.0},
		[2] = {100,6.5},
		[3] = {260,8.0},
		[4] = {560,10.0},
		[5] = {2500,15.0},
	},
	["youmu"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["rin"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["utsuho"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["reimu"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["daiyousei"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["cirno_ex"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["remilia"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["flandre"] = {
		[1] = {28,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["sakuya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["koishi"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["koakuma"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["meirin"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["yuuka"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["yukari"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["ran"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["chen"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["eirin"] = {
		[1] = {35,4.0},
		[2] = {130,6},
		[3] = {300,8},
		[4] = {600,10},
		[5] = {2600,20.0},
	},
	["mokou"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["kaguya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["aya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["hatate"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["momiji"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["sanae"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["kanako"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["suwako"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["minamitsu"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["nue"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["rumia_ex"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["toramaru"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["shinki"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["byakuren"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["soga"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["miko"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["futo"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["yoshika"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["seiga"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["keine"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["medicine"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["luna"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["star"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["sunny"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["yuugi"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["suika"] = 
	{
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["junko"] = {
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["hecatia"] = {
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["alice"] = {
		[1] = {30,3.0},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["kokoro"] = {
		[1] = {30,3.0},
		[2] = {100,5.0},
		[3] = {250,6.5},
		[4] = {600,8.0},
		[5] = {2400,15.0},
	},
	["hina"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},	
}

-- 这个表是每颗星增加多少攻击
-- 前一位数据代表基础攻击，后一位数据代表成长攻击

thtd_attack_table = 
{
	["lily"] = {
		[1] = {0,0},
		[2] = {0,0},
		[3] = {0,0},
		[4] = {0,0},
		[5] = {0,0},
	},
	["nazrin"] = {
		[1] = {10,1},
		[2] = {40,2},
		[3] = {100,4},
		[4] = {200,5},
		[5] = {500,6},
	},
	["mugiyousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["shanghainingyou"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["hourainingyou"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["hanadayousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["maidyousei"] = {
		[1] = {10,2},
		[2] = {55,3},
		[3] = {145,4},
		[4] = {350,6.5},
		[5] = {1400,26},
	},
	["cirno"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["kogasa"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["letty"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["lyrica"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["lunasa"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["merlin"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["rumia"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["satori"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["iku"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["mystia"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["marisa"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["marisa"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["tenshi"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["patchouli"] = {
		[1] = {10,1.0},
		[2] = {50,1.0},
		[3] = {100,1.0},
		[4] = {150,1.0},
		[5] = {500,1.0},
	},
	["reisen"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["yuyuko"] = {
		[1] = {1,1.0},
		[2] = {1,1.0},
		[3] = {1,1.0},
		[4] = {1,1.0},
		[5] = {1,1.0},
	},
	["youmu"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["rin"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["utsuho"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["reimu"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["daiyousei"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["cirno_ex"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["remilia"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["flandre"] = {
		[1] = {28,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["sakuya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["koishi"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["koakuma"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["meirin"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["yuuka"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["yukari"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["ran"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["chen"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["eirin"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["mokou"] = {
		[1] = {30,2.5},
		[2] = {105,4.0},
		[3] = {230,5},
		[4] = {450 ,7.0},
		[5] = {2300,12},
	},
	["kaguya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["aya"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["hatate"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["momiji"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["sanae"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["kanako"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["suwako"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["minamitsu"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["nue"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["rumia_ex"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["toramaru"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["shinki"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["byakuren"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["soga"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["miko"] = {
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["futo"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["yoshika"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["seiga"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["keine"] = {
		[1] = {20,2.5},
		[2] = {75,4.0},
		[3] = {190,5},
		[4] = {400,7.0},
		[5] = {2000,12},
	},
	["medicine"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["luna"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["star"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["sunny"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
	["yuugi"] = 
	{
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["suika"] = 
	{
		[1] = {25,3.0},
		[2] = {85,4.5},
		[3] = {220,5},
		[4] = {450,7.5},
		[5] = {2200,15.0},
	},
	["junko"] = {
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["hecatia"] = {
		[1] = {30,3.0},
		[2] = {110,5.0},
		[3] = {300,7.5},
		[4] = {600,10.0},
		[5] = {2400,30.0},
	},
	["alice"] = {
		[1] = {10,1.0},
		[2] = {50,1.0},
		[3] = {100,1.0},
		[4] = {150,1.0},
		[5] = {500,1.0},
	},
	["kokoro"] = {
		[1] = {10,1.0},
		[2] = {50,1.0},
		[3] = {100,1.0},
		[4] = {150,1.0},
		[5] = {500,1.0},
	},
	["hina"] = {
		[1] = {15,2},
		[2] = {60,3.5},
		[3] = {160,5},
		[4] = {375,6.5},
		[5] = {1800,10},
	},
}

-- 这个表是用于解封技能
thtd_ability_table = 
{
	["lily"] = {
		[1] = {["thtd_lily_01"] = 1,["thtd_lily_02"] = 0},
		[2] = {["thtd_lily_01"] = 1,["thtd_lily_02"] = 0},
		[3] = {["thtd_lily_01"] = 1,["thtd_lily_02"] = 0},
		[4] = {["thtd_lily_01"] = 1,["thtd_lily_02"] = 1},
		[5] = {["thtd_lily_01"] = 1,["thtd_lily_02"] = 2},
	},
	["nazrin"] = {
		[1] = {["thtd_nazrin_01"] = 1},
		[2] = {["thtd_nazrin_01"] = 1},
		[3] = {["thtd_nazrin_01"] = 1},
		[4] = {["thtd_nazrin_01"] = 1},
		[5] = {["thtd_nazrin_01"] = 1},
	},
	["minoriko"] = {
		[1] = {["thtd_minoriko_01"] = 1,["thtd_minoriko_02"] = 0},
		[2] = {["thtd_minoriko_01"] = 1,["thtd_minoriko_02"] = 0},
		[3] = {["thtd_minoriko_01"] = 1,["thtd_minoriko_02"] = 1},
		[4] = {["thtd_minoriko_01"] = 1,["thtd_minoriko_02"] = 1},
		[5] = {["thtd_minoriko_01"] = 1,["thtd_minoriko_02"] = 1},
	},
	["mugiyousei"] = {
		[1] = {["thtd_mugiyousei_01"] = 1},
		[2] = {["thtd_mugiyousei_01"] = 1},
		[3] = {["thtd_mugiyousei_01"] = 1},
		[4] = {["thtd_mugiyousei_01"] = 1},
		[5] = {["thtd_mugiyousei_01"] = 1},
	},
	["shanghainingyou"] = {
		[1] = {["thtd_shanghainingyou_01"] = 1},
		[2] = {["thtd_shanghainingyou_01"] = 1},
		[3] = {["thtd_shanghainingyou_01"] = 1},
		[4] = {["thtd_shanghainingyou_01"] = 1},
		[5] = {["thtd_shanghainingyou_01"] = 1},
	},
	["hourainingyou"] = {
		[1] = {["thtd_hourainingyou_01"] = 1},
		[2] = {["thtd_hourainingyou_01"] = 1},
		[3] = {["thtd_hourainingyou_01"] = 1},
		[4] = {["thtd_hourainingyou_01"] = 1},
		[5] = {["thtd_hourainingyou_01"] = 1},
	},
	["hanadayousei"] = {
		[1] = {["thtd_hanadayousei_01"] = 1},
		[2] = {["thtd_hanadayousei_01"] = 1},
		[3] = {["thtd_hanadayousei_01"] = 1},
		[4] = {["thtd_hanadayousei_01"] = 1},
		[5] = {["thtd_hanadayousei_01"] = 1},
	},
	["maidyousei"] = {
		[1] = {["luna_moon_glaive"] = 1},
		[2] = {["luna_moon_glaive"] = 1},
		[3] = {["luna_moon_glaive"] = 1},
		[4] = {["luna_moon_glaive"] = 1},
		[5] = {["luna_moon_glaive"] = 1},
	},
	["cirno"] = {
		[1] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[2] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[3] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[4] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 1,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[5] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 1,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
	},
	["letty"] = {
		[1] = {["thtd_letty_01"] = 1,["thtd_letty_02"] = 0},
		[2] = {["thtd_letty_01"] = 1,["thtd_letty_02"] = 0},
		[3] = {["thtd_letty_01"] = 1,["thtd_letty_02"] = 1},
		[4] = {["thtd_letty_01"] = 1,["thtd_letty_02"] = 2},
		[5] = {["thtd_letty_01"] = 1,["thtd_letty_02"] = 3},
	},
	["kogasa"] = {
		[1] = {["thtd_kogasa_01"] = 1,["thtd_kogasa_02"] = 0},
		[2] = {["thtd_kogasa_01"] = 1,["thtd_kogasa_02"] = 0},
		[3] = {["thtd_kogasa_01"] = 1,["thtd_kogasa_02"] = 1},
		[4] = {["thtd_kogasa_01"] = 1,["thtd_kogasa_02"] = 2},
		[5] = {["thtd_kogasa_01"] = 1,["thtd_kogasa_02"] = 3},
	},
	["lyrica"] = {
		[1] = {["thtd_lyrica_01"] = 1,["thtd_lyrica_02"] = 0},
		[2] = {["thtd_lyrica_01"] = 1,["thtd_lyrica_02"] = 0},
		[3] = {["thtd_lyrica_01"] = 1,["thtd_lyrica_02"] = 1},
		[4] = {["thtd_lyrica_01"] = 1,["thtd_lyrica_02"] = 1},
		[5] = {["thtd_lyrica_01"] = 1,["thtd_lyrica_02"] = 1},
	},
	["lunasa"] = {
		[1] = {["thtd_lunasa_01"] = 1,["thtd_lunasa_02"] = 0},
		[2] = {["thtd_lunasa_01"] = 1,["thtd_lunasa_02"] = 0},
		[3] = {["thtd_lunasa_01"] = 1,["thtd_lunasa_02"] = 1},
		[4] = {["thtd_lunasa_01"] = 1,["thtd_lunasa_02"] = 1},
		[5] = {["thtd_lunasa_01"] = 1,["thtd_lunasa_02"] = 1},
	},
	["merlin"] = {
		[1] = {["thtd_merlin_01"] = 1,["thtd_merlin_02"] = 0},
		[2] = {["thtd_merlin_01"] = 2,["thtd_merlin_02"] = 0},
		[3] = {["thtd_merlin_01"] = 3,["thtd_merlin_02"] = 1},
		[4] = {["thtd_merlin_01"] = 4,["thtd_merlin_02"] = 1},
		[5] = {["thtd_merlin_01"] = 5,["thtd_merlin_02"] = 1},
	},
	["rumia"] = {
		[1] = {["thtd_rumia_01"] = 1,["thtd_rumia_02"] = 0,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[2] = {["thtd_rumia_01"] = 2,["thtd_rumia_02"] = 0,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[3] = {["thtd_rumia_01"] = 3,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[4] = {["thtd_rumia_01"] = 4,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[5] = {["thtd_rumia_01"] = 5,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
	},
	["satori"] = {
		[1] = {["thtd_satori_01"] = 1,["thtd_satori_02"] = 0},
		[2] = {["thtd_satori_01"] = 2,["thtd_satori_02"] = 0},
		[3] = {["thtd_satori_01"] = 3,["thtd_satori_02"] = 0},
		[4] = {["thtd_satori_01"] = 4,["thtd_satori_02"] = 1},
		[5] = {["thtd_satori_01"] = 5,["thtd_satori_02"] = 1},
	},
	["iku"] = {
		[1] = {["thtd_iku_01"] = 1,["thtd_iku_02"] = 0},
		[2] = {["thtd_iku_01"] = 2,["thtd_iku_02"] = 0},
		[3] = {["thtd_iku_01"] = 3,["thtd_iku_02"] = 0},
		[4] = {["thtd_iku_01"] = 4,["thtd_iku_02"] = 1},
		[5] = {["thtd_iku_01"] = 5,["thtd_iku_02"] = 1},
	},
	["mystia"] = {
		[1] = {["thtd_mystia_01"] = 1,["thtd_mystia_02"] = 0},
		[2] = {["thtd_mystia_01"] = 2,["thtd_mystia_02"] = 0},
		[3] = {["thtd_mystia_01"] = 3,["thtd_mystia_02"] = 1},
		[4] = {["thtd_mystia_01"] = 4,["thtd_mystia_02"] = 2},
		[5] = {["thtd_mystia_01"] = 5,["thtd_mystia_02"] = 3},
	},
	["marisa"] = {
		[1] = {["thtd_marisa_01"] = 1,["thtd_marisa_02"] = 1,["thtd_marisa_03"] = 0},
		[2] = {["thtd_marisa_01"] = 1,["thtd_marisa_02"] = 1,["thtd_marisa_03"] = 0},
		[3] = {["thtd_marisa_01"] = 1,["thtd_marisa_02"] = 1,["thtd_marisa_03"] = 0},
		[4] = {["thtd_marisa_01"] = 1,["thtd_marisa_02"] = 1,["thtd_marisa_03"] = 1},
		[5] = {["thtd_marisa_01"] = 1,["thtd_marisa_02"] = 1,["thtd_marisa_03"] = 1},
	},
	["tenshi"] = {
		[1] = {["thtd_tenshi_01"] = 1,["thtd_tenshi_02"] = 1,["thtd_tenshi_03"] = 0},
		[2] = {["thtd_tenshi_01"] = 1,["thtd_tenshi_02"] = 1,["thtd_tenshi_03"] = 0},
		[3] = {["thtd_tenshi_01"] = 1,["thtd_tenshi_02"] = 1,["thtd_tenshi_03"] = 0},
		[4] = {["thtd_tenshi_01"] = 1,["thtd_tenshi_02"] = 1,["thtd_tenshi_03"] = 1},
		[5] = {["thtd_tenshi_01"] = 1,["thtd_tenshi_02"] = 1,["thtd_tenshi_03"] = 1},
	},
	["patchouli"] = {
		[1] = {["thtd_patchouli_01"] = 1,["thtd_patchouli_02"] = 1,["thtd_patchouli_03"] = 0},
		[2] = {["thtd_patchouli_01"] = 2,["thtd_patchouli_02"] = 1,["thtd_patchouli_03"] = 0},
		[3] = {["thtd_patchouli_01"] = 3,["thtd_patchouli_02"] = 1,["thtd_patchouli_03"] = 1},
		[4] = {["thtd_patchouli_01"] = 4,["thtd_patchouli_02"] = 1,["thtd_patchouli_03"] = 1},
		[5] = {["thtd_patchouli_01"] = 5,["thtd_patchouli_02"] = 1,["thtd_patchouli_03"] = 1},
	},
	["reisen"] = {
		[1] = {["thtd_reisen_01"] = 1,["thtd_reisen_02"] = 1,["thtd_reisen_03"] = 0},
		[2] = {["thtd_reisen_01"] = 2,["thtd_reisen_02"] = 1,["thtd_reisen_03"] = 0},
		[3] = {["thtd_reisen_01"] = 3,["thtd_reisen_02"] = 1,["thtd_reisen_03"] = 0},
		[4] = {["thtd_reisen_01"] = 4,["thtd_reisen_02"] = 1,["thtd_reisen_03"] = 1},
		[5] = {["thtd_reisen_01"] = 5,["thtd_reisen_02"] = 1,["thtd_reisen_03"] = 1},
	},
	["yuyuko"] = {
		[1] = {["thtd_yuyuko_01"] = 1,["thtd_yuyuko_02"] = 1,["thtd_yuyuko_03"] = 0},
		[2] = {["thtd_yuyuko_01"] = 2,["thtd_yuyuko_02"] = 1,["thtd_yuyuko_03"] = 0},
		[3] = {["thtd_yuyuko_01"] = 3,["thtd_yuyuko_02"] = 1,["thtd_yuyuko_03"] = 0},
		[4] = {["thtd_yuyuko_01"] = 4,["thtd_yuyuko_02"] = 1,["thtd_yuyuko_03"] = 1},
		[5] = {["thtd_yuyuko_01"] = 5,["thtd_yuyuko_02"] = 1,["thtd_yuyuko_03"] = 1},
	},
	["youmu"] = {
		[1] = {["thtd_youmu_01"] = 1,["thtd_youmu_02"] = 1,["thtd_youmu_03"] = 0},
		[2] = {["thtd_youmu_01"] = 1,["thtd_youmu_02"] = 1,["thtd_youmu_03"] = 0},
		[3] = {["thtd_youmu_01"] = 1,["thtd_youmu_02"] = 1,["thtd_youmu_03"] = 0},
		[4] = {["thtd_youmu_01"] = 1,["thtd_youmu_02"] = 1,["thtd_youmu_03"] = 1},
		[5] = {["thtd_youmu_01"] = 1,["thtd_youmu_02"] = 1,["thtd_youmu_03"] = 1},
	},
	["rin"] = {
		[1] = {["thtd_rin_01"] = 1,["thtd_rin_02"] = 0,},
		[2] = {["thtd_rin_01"] = 1,["thtd_rin_02"] = 0,},
		[3] = {["thtd_rin_01"] = 1,["thtd_rin_02"] = 1,},
		[4] = {["thtd_rin_01"] = 1,["thtd_rin_02"] = 1,},
		[5] = {["thtd_rin_01"] = 1,["thtd_rin_02"] = 1,},
	},
	["utsuho"] = {
		[1] = {["thtd_utsuho_01"] = 1,["thtd_utsuho_02"] = 1,["thtd_utsuho_03"] = 0,},
		[2] = {["thtd_utsuho_01"] = 1,["thtd_utsuho_02"] = 1,["thtd_utsuho_03"] = 0,},
		[3] = {["thtd_utsuho_01"] = 1,["thtd_utsuho_02"] = 1,["thtd_utsuho_03"] = 0,},
		[4] = {["thtd_utsuho_01"] = 1,["thtd_utsuho_02"] = 1,["thtd_utsuho_03"] = 1,},
		[5] = {["thtd_utsuho_01"] = 1,["thtd_utsuho_02"] = 1,["thtd_utsuho_03"] = 2,},
	},
	["reimu"] = {
		[1] = {["thtd_reimu_01"] = 1,["thtd_reimu_02"] = 1,["thtd_reimu_03"] = 0,["thtd_reimu_04"] = 0},
		[2] = {["thtd_reimu_01"] = 1,["thtd_reimu_02"] = 1,["thtd_reimu_03"] = 0,["thtd_reimu_04"] = 0},
		[3] = {["thtd_reimu_01"] = 1,["thtd_reimu_02"] = 1,["thtd_reimu_03"] = 1,["thtd_reimu_04"] = 0},
		[4] = {["thtd_reimu_01"] = 1,["thtd_reimu_02"] = 1,["thtd_reimu_03"] = 1,["thtd_reimu_04"] = 0},
		[5] = {["thtd_reimu_01"] = 1,["thtd_reimu_02"] = 1,["thtd_reimu_03"] = 1,["thtd_reimu_04"] = 1},
	},
	["daiyousei"] = {
		[1] = {["thtd_daiyousei_01"] = 1,["thtd_daiyousei_02"] = 1,["thtd_daiyousei_03"] = 0,["thtd_daiyousei_04"] = 0},
		[2] = {["thtd_daiyousei_01"] = 1,["thtd_daiyousei_02"] = 1,["thtd_daiyousei_03"] = 0,["thtd_daiyousei_04"] = 0},
		[3] = {["thtd_daiyousei_01"] = 1,["thtd_daiyousei_02"] = 1,["thtd_daiyousei_03"] = 1,["thtd_daiyousei_04"] = 0},
		[4] = {["thtd_daiyousei_01"] = 1,["thtd_daiyousei_02"] = 1,["thtd_daiyousei_03"] = 1,["thtd_daiyousei_04"] = 0},
		[5] = {["thtd_daiyousei_01"] = 1,["thtd_daiyousei_02"] = 1,["thtd_daiyousei_03"] = 1,["thtd_daiyousei_04"] = 1},
	},
	["cirno_ex"] = 
	{
		[1] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[2] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 0,["thtd_cirno_04"] = 0},
		[3] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 0,["thtd_cirno_03"] = 1,["thtd_cirno_04"] = 0},
		[4] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 1,["thtd_cirno_03"] = 1,["thtd_cirno_04"] = 0},
		[5] = {["thtd_cirno_01"] = 1,["thtd_cirno_02"] = 1,["thtd_cirno_03"] = 1,["thtd_cirno_04"] = 1},
	},
	["remilia"] = 
	{
		[1] = {["thtd_remilia_01"] = 1,["thtd_remilia_02"] = 1,["thtd_remilia_03"] = 0,["thtd_remilia_04"] = 0},
		[2] = {["thtd_remilia_01"] = 1,["thtd_remilia_02"] = 1,["thtd_remilia_03"] = 0,["thtd_remilia_04"] = 0},
		[3] = {["thtd_remilia_01"] = 1,["thtd_remilia_02"] = 1,["thtd_remilia_03"] = 1,["thtd_remilia_04"] = 0},
		[4] = {["thtd_remilia_01"] = 1,["thtd_remilia_02"] = 1,["thtd_remilia_03"] = 1,["thtd_remilia_04"] = 0},
		[5] = {["thtd_remilia_01"] = 1,["thtd_remilia_02"] = 1,["thtd_remilia_03"] = 1,["thtd_remilia_04"] = 1},
	},
	["flandre"] = 
	{
		[1] = {["thtd_flandre_01"] = 1,["thtd_flandre_02"] = 1,["thtd_flandre_03"] = 0,["thtd_flandre_04"] = 0},
		[2] = {["thtd_flandre_01"] = 1,["thtd_flandre_02"] = 1,["thtd_flandre_03"] = 0,["thtd_flandre_04"] = 0},
		[3] = {["thtd_flandre_01"] = 1,["thtd_flandre_02"] = 1,["thtd_flandre_03"] = 1,["thtd_flandre_04"] = 0},
		[4] = {["thtd_flandre_01"] = 1,["thtd_flandre_02"] = 1,["thtd_flandre_03"] = 1,["thtd_flandre_04"] = 0},
		[5] = {["thtd_flandre_01"] = 1,["thtd_flandre_02"] = 1,["thtd_flandre_03"] = 1,["thtd_flandre_04"] = 1},
	},
	["sakuya"] = 
	{
		[1] = {["thtd_sakuya_01"] = 1,["thtd_sakuya_02"] = 0,["thtd_sakuya_03"] = 0},
		[2] = {["thtd_sakuya_01"] = 1,["thtd_sakuya_02"] = 0,["thtd_sakuya_03"] = 0},
		[3] = {["thtd_sakuya_01"] = 1,["thtd_sakuya_02"] = 1,["thtd_sakuya_03"] = 0},
		[4] = {["thtd_sakuya_01"] = 1,["thtd_sakuya_02"] = 1,["thtd_sakuya_03"] = 1},
		[5] = {["thtd_sakuya_01"] = 1,["thtd_sakuya_02"] = 1,["thtd_sakuya_03"] = 1},
	},
	["koishi"] = 
	{
		[1] = {["thtd_koishi_01"] = 1,["thtd_koishi_02"] = 1,["thtd_koishi_03"] = 0,["thtd_koishi_04"] = 0},
		[2] = {["thtd_koishi_01"] = 1,["thtd_koishi_02"] = 1,["thtd_koishi_03"] = 0,["thtd_koishi_04"] = 0},
		[3] = {["thtd_koishi_01"] = 1,["thtd_koishi_02"] = 1,["thtd_koishi_03"] = 1,["thtd_koishi_04"] = 0},
		[4] = {["thtd_koishi_01"] = 1,["thtd_koishi_02"] = 1,["thtd_koishi_03"] = 1,["thtd_koishi_04"] = 0},
		[5] = {["thtd_koishi_01"] = 1,["thtd_koishi_02"] = 1,["thtd_koishi_03"] = 1,["thtd_koishi_04"] = 1},
	},
	["koakuma"] = 
	{
		[1] = {["thtd_koakuma_01"] = 1,["thtd_koakuma_02"] = 0},
		[2] = {["thtd_koakuma_01"] = 1,["thtd_koakuma_02"] = 0},
		[3] = {["thtd_koakuma_01"] = 1,["thtd_koakuma_02"] = 1},
		[4] = {["thtd_koakuma_01"] = 1,["thtd_koakuma_02"] = 2},
		[5] = {["thtd_koakuma_01"] = 1,["thtd_koakuma_02"] = 3},
	},
	["meirin"] = 
	{
		[1] = {["thtd_meirin_01"] = 1,["thtd_meirin_02"] = 1},
		[2] = {["thtd_meirin_01"] = 1,["thtd_meirin_02"] = 1},
		[3] = {["thtd_meirin_01"] = 1,["thtd_meirin_02"] = 3},
		[4] = {["thtd_meirin_01"] = 1,["thtd_meirin_02"] = 3},
		[5] = {["thtd_meirin_01"] = 1,["thtd_meirin_02"] = 5},
	},
	["yuuka"] = 
	{
		[1] = {["thtd_yuuka_01"] = 1,["thtd_yuuka_02"] = 1,["thtd_yuuka_03"] = 0,["thtd_yuuka_04"] = 0},
		[2] = {["thtd_yuuka_01"] = 1,["thtd_yuuka_02"] = 1,["thtd_yuuka_03"] = 0,["thtd_yuuka_04"] = 0},
		[3] = {["thtd_yuuka_01"] = 1,["thtd_yuuka_02"] = 1,["thtd_yuuka_03"] = 1,["thtd_yuuka_04"] = 0},
		[4] = {["thtd_yuuka_01"] = 1,["thtd_yuuka_02"] = 1,["thtd_yuuka_03"] = 1,["thtd_yuuka_04"] = 0},
		[5] = {["thtd_yuuka_01"] = 1,["thtd_yuuka_02"] = 1,["thtd_yuuka_03"] = 1,["thtd_yuuka_04"] = 1},
	},
	["yukari"] = 
	{
		[1] = {["thtd_yukari_01"] = 1,["thtd_yukari_02"] = 1,["thtd_yukari_03"] = 0,["thtd_yukari_04"] = 0},
		[2] = {["thtd_yukari_01"] = 1,["thtd_yukari_02"] = 1,["thtd_yukari_03"] = 0,["thtd_yukari_04"] = 0},
		[3] = {["thtd_yukari_01"] = 1,["thtd_yukari_02"] = 1,["thtd_yukari_03"] = 1,["thtd_yukari_04"] = 0},
		[4] = {["thtd_yukari_01"] = 1,["thtd_yukari_02"] = 1,["thtd_yukari_03"] = 1,["thtd_yukari_04"] = 0},
		[5] = {["thtd_yukari_01"] = 1,["thtd_yukari_02"] = 1,["thtd_yukari_03"] = 1,["thtd_yukari_04"] = 1},
	},
	["ran"] = 
	{
		[1] = {["thtd_ran_01"] = 1,["thtd_ran_02"] = 1,["thtd_ran_03"] = 0},
		[2] = {["thtd_ran_01"] = 1,["thtd_ran_02"] = 2,["thtd_ran_03"] = 0},
		[3] = {["thtd_ran_01"] = 1,["thtd_ran_02"] = 3,["thtd_ran_03"] = 0},
		[4] = {["thtd_ran_01"] = 1,["thtd_ran_02"] = 4,["thtd_ran_03"] = 1},
		[5] = {["thtd_ran_01"] = 1,["thtd_ran_02"] = 5,["thtd_ran_03"] = 1},
	},
	["chen"] = 
	{
		[1] = {["thtd_chen_01"] = 1},
		[2] = {["thtd_chen_01"] = 2},
		[3] = {["thtd_chen_01"] = 3},
		[4] = {["thtd_chen_01"] = 4},
		[5] = {["thtd_chen_01"] = 5},
	},
	["eirin"] = 
	{
		[1] = {["thtd_eirin_01"] = 1,["thtd_eirin_02"] = 1,["thtd_eirin_03"] = 0,["thtd_eirin_04"] = 0},
		[2] = {["thtd_eirin_01"] = 1,["thtd_eirin_02"] = 1,["thtd_eirin_03"] = 0,["thtd_eirin_04"] = 0},
		[3] = {["thtd_eirin_01"] = 1,["thtd_eirin_02"] = 1,["thtd_eirin_03"] = 1,["thtd_eirin_04"] = 0},
		[4] = {["thtd_eirin_01"] = 1,["thtd_eirin_02"] = 1,["thtd_eirin_03"] = 1,["thtd_eirin_04"] = 0},
		[5] = {["thtd_eirin_01"] = 1,["thtd_eirin_02"] = 1,["thtd_eirin_03"] = 1,["thtd_eirin_04"] = 1},
	},
	["mokou"] = 
	{
		[1] = {["thtd_mokou_01"] = 1,["thtd_mokou_02"] = 1,["thtd_mokou_03"] = 0},
		[2] = {["thtd_mokou_01"] = 1,["thtd_mokou_02"] = 1,["thtd_mokou_03"] = 0},
		[3] = {["thtd_mokou_01"] = 1,["thtd_mokou_02"] = 1,["thtd_mokou_03"] = 0},
		[4] = {["thtd_mokou_01"] = 1,["thtd_mokou_02"] = 1,["thtd_mokou_03"] = 1},
		[5] = {["thtd_mokou_01"] = 1,["thtd_mokou_02"] = 1,["thtd_mokou_03"] = 1},
	},
	["kaguya"] = 
	{
		[1] = {["thtd_kaguya_01"] = 1,["thtd_kaguya_02"] = 1,["thtd_kaguya_03"] = 0},
		[2] = {["thtd_kaguya_01"] = 1,["thtd_kaguya_02"] = 2,["thtd_kaguya_03"] = 0},
		[3] = {["thtd_kaguya_01"] = 1,["thtd_kaguya_02"] = 3,["thtd_kaguya_03"] = 0},
		[4] = {["thtd_kaguya_01"] = 1,["thtd_kaguya_02"] = 4,["thtd_kaguya_03"] = 1},
		[5] = {["thtd_kaguya_01"] = 1,["thtd_kaguya_02"] = 5,["thtd_kaguya_03"] = 2},
	},

	["aya"] = 
	{
		[1] = {["thtd_aya_01"] = 1,["thtd_aya_02"] = 0,["thtd_aya_03"] = 0},
		[2] = {["thtd_aya_01"] = 1,["thtd_aya_02"] = 0,["thtd_aya_03"] = 0},
		[3] = {["thtd_aya_01"] = 1,["thtd_aya_02"] = 0,["thtd_aya_03"] = 0},
		[4] = {["thtd_aya_01"] = 1,["thtd_aya_02"] = 1,["thtd_aya_03"] = 1},
		[5] = {["thtd_aya_01"] = 1,["thtd_aya_02"] = 1,["thtd_aya_03"] = 1},
	},

	["hatate"] = 
	{
		[1] = {["thtd_hatate_01"] = 1,["thtd_hatate_02"] = 0},
		[2] = {["thtd_hatate_01"] = 1,["thtd_hatate_02"] = 0},
		[3] = {["thtd_hatate_01"] = 1,["thtd_hatate_02"] = 0},
		[4] = {["thtd_hatate_01"] = 1,["thtd_hatate_02"] = 1},
		[5] = {["thtd_hatate_01"] = 1,["thtd_hatate_02"] = 1},
	},

	["momiji"] = 
	{
		[1] = {["thtd_momiji_01"] = 1,["thtd_momiji_02"] = 0},
		[2] = {["thtd_momiji_01"] = 1,["thtd_momiji_02"] = 0},
		[3] = {["thtd_momiji_01"] = 1,["thtd_momiji_02"] = 1},
		[4] = {["thtd_momiji_01"] = 1,["thtd_momiji_02"] = 1},
		[5] = {["thtd_momiji_01"] = 1,["thtd_momiji_02"] = 1},
	},

	["sanae"] = 
	{
		[1] = {["thtd_sanae_01"] = 1,["thtd_sanae_02"] = 1,["thtd_sanae_03"] = 0,["thtd_sanae_04"] = 0},
		[2] = {["thtd_sanae_01"] = 1,["thtd_sanae_02"] = 2,["thtd_sanae_03"] = 0,["thtd_sanae_04"] = 0},
		[3] = {["thtd_sanae_01"] = 1,["thtd_sanae_02"] = 3,["thtd_sanae_03"] = 0,["thtd_sanae_04"] = 0},
		[4] = {["thtd_sanae_01"] = 1,["thtd_sanae_02"] = 4,["thtd_sanae_03"] = 1,["thtd_sanae_04"] = 0},
		[5] = {["thtd_sanae_01"] = 1,["thtd_sanae_02"] = 5,["thtd_sanae_03"] = 1,["thtd_sanae_04"] = 0},
	},

	["kanako"] = 
	{
		[1] = {["thtd_kanako_01"] = 1,["thtd_kanako_02"] = 0,["thtd_kanako_03"] = 0,["thtd_kanako_04"] = 0},
		[2] = {["thtd_kanako_01"] = 1,["thtd_kanako_02"] = 0,["thtd_kanako_03"] = 0,["thtd_kanako_04"] = 0},
		[3] = {["thtd_kanako_01"] = 1,["thtd_kanako_02"] = 1,["thtd_kanako_03"] = 1,["thtd_kanako_04"] = 0},
		[4] = {["thtd_kanako_01"] = 1,["thtd_kanako_02"] = 1,["thtd_kanako_03"] = 1,["thtd_kanako_04"] = 0},
		[5] = {["thtd_kanako_01"] = 1,["thtd_kanako_02"] = 1,["thtd_kanako_03"] = 1,["thtd_kanako_04"] = 1},
	},

	["suwako"] = 
	{
		[1] = {["thtd_suwako_01"] = 1,["thtd_suwako_02"] = 0,["thtd_suwako_03"] = 0,["thtd_suwako_04"] = 0},
		[2] = {["thtd_suwako_01"] = 1,["thtd_suwako_02"] = 0,["thtd_suwako_03"] = 0,["thtd_suwako_04"] = 0},
		[3] = {["thtd_suwako_01"] = 1,["thtd_suwako_02"] = 1,["thtd_suwako_03"] = 0,["thtd_suwako_04"] = 0},
		[4] = {["thtd_suwako_01"] = 1,["thtd_suwako_02"] = 1,["thtd_suwako_03"] = 1,["thtd_suwako_04"] = 0},
		[5] = {["thtd_suwako_01"] = 1,["thtd_suwako_02"] = 1,["thtd_suwako_03"] = 1,["thtd_suwako_04"] = 1},
	},

	["minamitsu"] = 
	{
		[1] = {["thtd_minamitsu_01"] = 1,["thtd_minamitsu_02"] = 1,["thtd_minamitsu_03"] = 0,["thtd_minamitsu_04"] = 0},
		[2] = {["thtd_minamitsu_01"] = 2,["thtd_minamitsu_02"] = 1,["thtd_minamitsu_03"] = 0,["thtd_minamitsu_04"] = 0},
		[3] = {["thtd_minamitsu_01"] = 3,["thtd_minamitsu_02"] = 1,["thtd_minamitsu_03"] = 0,["thtd_minamitsu_04"] = 0},
		[4] = {["thtd_minamitsu_01"] = 4,["thtd_minamitsu_02"] = 1,["thtd_minamitsu_03"] = 1,["thtd_minamitsu_04"] = 0},
		[5] = {["thtd_minamitsu_01"] = 5,["thtd_minamitsu_02"] = 1,["thtd_minamitsu_03"] = 1,["thtd_minamitsu_04"] = 1},
	},

	["nue"] = 
	{
		[1] = {["thtd_nue_01"] = 1,["thtd_nue_02"] = 0,["thtd_nue_03"] = 0},
		[2] = {["thtd_nue_01"] = 1,["thtd_nue_02"] = 0,["thtd_nue_03"] = 0},
		[3] = {["thtd_nue_01"] = 1,["thtd_nue_02"] = 1,["thtd_nue_03"] = 0},
		[4] = {["thtd_nue_01"] = 1,["thtd_nue_02"] = 1,["thtd_nue_03"] = 1},
		[5] = {["thtd_nue_01"] = 1,["thtd_nue_02"] = 1,["thtd_nue_03"] = 1},
	},

	["rumia_ex"] = 
	{
		[1] = {["thtd_rumia_01"] = 1,["thtd_rumia_02"] = 0,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[2] = {["thtd_rumia_01"] = 2,["thtd_rumia_02"] = 0,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[3] = {["thtd_rumia_01"] = 3,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 0,["thtd_rumia_04"] = 0},
		[4] = {["thtd_rumia_01"] = 4,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 1,["thtd_rumia_04"] = 0},
		[5] = {["thtd_rumia_01"] = 5,["thtd_rumia_02"] = 1,["thtd_rumia_03"] = 1,["thtd_rumia_04"] = 1},
	},

	["sizuha"] = {
		[1] = {["thtd_sizuha_01"] = 1,["thtd_sizuha_02"] = 0},
		[2] = {["thtd_sizuha_01"] = 1,["thtd_sizuha_02"] = 1},
		[3] = {["thtd_sizuha_01"] = 1,["thtd_sizuha_02"] = 1},
		[4] = {["thtd_sizuha_01"] = 1,["thtd_sizuha_02"] = 1},
		[5] = {["thtd_sizuha_01"] = 1,["thtd_sizuha_02"] = 1},
	},

	["toramaru"] = {
		[1] = {["thtd_toramaru_01"] = 1,["thtd_toramaru_02"] = 0,["thtd_toramaru_03"] = 0,["thtd_toramaru_04"] = 0},
		[2] = {["thtd_toramaru_01"] = 1,["thtd_toramaru_02"] = 0,["thtd_toramaru_03"] = 0,["thtd_toramaru_04"] = 0},
		[3] = {["thtd_toramaru_01"] = 1,["thtd_toramaru_02"] = 1,["thtd_toramaru_03"] = 0,["thtd_toramaru_04"] = 1},
		[4] = {["thtd_toramaru_01"] = 1,["thtd_toramaru_02"] = 1,["thtd_toramaru_03"] = 0,["thtd_toramaru_04"] = 1},
		[5] = {["thtd_toramaru_01"] = 1,["thtd_toramaru_02"] = 1,["thtd_toramaru_03"] = 1,["thtd_toramaru_04"] = 1},
	},

	["shinki"] = {
		[1] = {["thtd_shinki_01"] = 1,["thtd_shinki_02"] = 1,["thtd_shinki_03"] = 0,["thtd_shinki_04"] = 0},
		[2] = {["thtd_shinki_01"] = 1,["thtd_shinki_02"] = 1,["thtd_shinki_03"] = 0,["thtd_shinki_04"] = 0},
		[3] = {["thtd_shinki_01"] = 1,["thtd_shinki_02"] = 1,["thtd_shinki_03"] = 0,["thtd_shinki_04"] = 0},
		[4] = {["thtd_shinki_01"] = 1,["thtd_shinki_02"] = 1,["thtd_shinki_03"] = 0,["thtd_shinki_04"] = 1},
		[5] = {["thtd_shinki_01"] = 1,["thtd_shinki_02"] = 1,["thtd_shinki_03"] = 1,["thtd_shinki_04"] = 1},
	},

	["byakuren"] = {
		[1] = {["thtd_byakuren_01"] = 1,["thtd_byakuren_02"] = 1,["thtd_byakuren_03"] = 0,["thtd_byakuren_04"] = 0},
		[2] = {["thtd_byakuren_01"] = 1,["thtd_byakuren_02"] = 1,["thtd_byakuren_03"] = 0,["thtd_byakuren_04"] = 0},
		[3] = {["thtd_byakuren_01"] = 1,["thtd_byakuren_02"] = 1,["thtd_byakuren_03"] = 1,["thtd_byakuren_04"] = 0},
		[4] = {["thtd_byakuren_01"] = 1,["thtd_byakuren_02"] = 1,["thtd_byakuren_03"] = 1,["thtd_byakuren_04"] = 0},
		[5] = {["thtd_byakuren_01"] = 1,["thtd_byakuren_02"] = 1,["thtd_byakuren_03"] = 1,["thtd_byakuren_04"] = 1},
	},

	["soga"] = {
		[1] = {["thtd_soga_01"] = 1,["thtd_soga_02"] = 0,["thtd_soga_03"] = 0},
		[2] = {["thtd_soga_01"] = 1,["thtd_soga_02"] = 0,["thtd_soga_03"] = 0},
		[3] = {["thtd_soga_01"] = 1,["thtd_soga_02"] = 1,["thtd_soga_03"] = 0},
		[4] = {["thtd_soga_01"] = 1,["thtd_soga_02"] = 1,["thtd_soga_03"] = 1},
		[5] = {["thtd_soga_01"] = 1,["thtd_soga_02"] = 1,["thtd_soga_03"] = 1},
	},

	["miko"] = {
		[1] = {["thtd_miko_01"] = 1,["thtd_miko_02"] = 1,["thtd_miko_03"] = 0,["thtd_miko_04"] = 0},
		[2] = {["thtd_miko_01"] = 1,["thtd_miko_02"] = 1,["thtd_miko_03"] = 0,["thtd_miko_04"] = 0},
		[3] = {["thtd_miko_01"] = 1,["thtd_miko_02"] = 1,["thtd_miko_03"] = 1,["thtd_miko_04"] = 0},
		[4] = {["thtd_miko_01"] = 1,["thtd_miko_02"] = 1,["thtd_miko_03"] = 1,["thtd_miko_04"] = 0},
		[5] = {["thtd_miko_01"] = 1,["thtd_miko_02"] = 1,["thtd_miko_03"] = 1,["thtd_miko_04"] = 1},
	},

	["futo"] = {
		[1] = {["thtd_futo_01"] = 1,["thtd_futo_02"] = 0,["thtd_futo_03"] = 0},
		[2] = {["thtd_futo_01"] = 1,["thtd_futo_02"] = 0,["thtd_futo_03"] = 0},
		[3] = {["thtd_futo_01"] = 1,["thtd_futo_02"] = 1,["thtd_futo_03"] = 0},
		[4] = {["thtd_futo_01"] = 1,["thtd_futo_02"] = 1,["thtd_futo_03"] = 1},
		[5] = {["thtd_futo_01"] = 1,["thtd_futo_02"] = 1,["thtd_futo_03"] = 1},
	},

	["yoshika"] = {
		[1] = {["thtd_yoshika_01"] = 1,["thtd_yoshika_02"] = 0},
		[2] = {["thtd_yoshika_01"] = 2,["thtd_yoshika_02"] = 0},
		[3] = {["thtd_yoshika_01"] = 3,["thtd_yoshika_02"] = 1},
		[4] = {["thtd_yoshika_01"] = 4,["thtd_yoshika_02"] = 1},
		[5] = {["thtd_yoshika_01"] = 5,["thtd_yoshika_02"] = 1},
	},

	["seiga"] = {
		[1] = {["thtd_seiga_01"] = 1,["thtd_seiga_02"] = 1,["thtd_seiga_03"] = 0},
		[2] = {["thtd_seiga_01"] = 1,["thtd_seiga_02"] = 2,["thtd_seiga_03"] = 0},
		[3] = {["thtd_seiga_01"] = 1,["thtd_seiga_02"] = 3,["thtd_seiga_03"] = 0},
		[4] = {["thtd_seiga_01"] = 1,["thtd_seiga_02"] = 4,["thtd_seiga_03"] = 1},
		[5] = {["thtd_seiga_01"] = 1,["thtd_seiga_02"] = 5,["thtd_seiga_03"] = 1},
	},

	["keine"] = {
		[1] = {["thtd_keine_01"] = 1,["thtd_keine_02"] = 1,["thtd_keine_03"] = 0,["thtd_keine_04"] = 0},
		[2] = {["thtd_keine_01"] = 1,["thtd_keine_02"] = 1,["thtd_keine_03"] = 0,["thtd_keine_04"] = 0},
		[3] = {["thtd_keine_01"] = 1,["thtd_keine_02"] = 1,["thtd_keine_03"] = 1,["thtd_keine_04"] = 0},
		[4] = {["thtd_keine_01"] = 1,["thtd_keine_02"] = 1,["thtd_keine_03"] = 1,["thtd_keine_04"] = 1},
		[5] = {["thtd_keine_01"] = 1,["thtd_keine_02"] = 1,["thtd_keine_03"] = 1,["thtd_keine_04"] = 1},
	},

	["medicine"] = {
		[1] = {["thtd_medicine_01"] = 1,["thtd_medicine_02"] = 0},
		[2] = {["thtd_medicine_01"] = 2,["thtd_medicine_02"] = 0},
		[3] = {["thtd_medicine_01"] = 3,["thtd_medicine_02"] = 1},
		[4] = {["thtd_medicine_01"] = 4,["thtd_medicine_02"] = 1},
		[5] = {["thtd_medicine_01"] = 5,["thtd_medicine_02"] = 1},
	},

	["luna"] = {
		[1] = {["thtd_luna_01"] = 1,["thtd_luna_02"] = 0},
		[2] = {["thtd_luna_01"] = 1,["thtd_luna_02"] = 0},
		[3] = {["thtd_luna_01"] = 1,["thtd_luna_02"] = 1},
		[4] = {["thtd_luna_01"] = 1,["thtd_luna_02"] = 1},
		[5] = {["thtd_luna_01"] = 1,["thtd_luna_02"] = 1},
	},

	["sunny"] = {
		[1] = {["thtd_sunny_01"] = 1,["thtd_sunny_02"] = 0},
		[2] = {["thtd_sunny_01"] = 1,["thtd_sunny_02"] = 0},
		[3] = {["thtd_sunny_01"] = 1,["thtd_sunny_02"] = 1},
		[4] = {["thtd_sunny_01"] = 1,["thtd_sunny_02"] = 1},
		[5] = {["thtd_sunny_01"] = 1,["thtd_sunny_02"] = 1},
	},

	["star"] = {
		[1] = {["thtd_star_01"] = 1,["thtd_star_02"] = 0},
		[2] = {["thtd_star_01"] = 2,["thtd_star_02"] = 0},
		[3] = {["thtd_star_01"] = 3,["thtd_star_02"] = 1},
		[4] = {["thtd_star_01"] = 4,["thtd_star_02"] = 1},
		[5] = {["thtd_star_01"] = 5,["thtd_star_02"] = 1},
	},

	["yuugi"] = {
		[1] = {["thtd_yuugi_01"] = 1,["thtd_yuugi_02"] = 0,["thtd_yuugi_03"] = 0},
		[2] = {["thtd_yuugi_01"] = 1,["thtd_yuugi_02"] = 0,["thtd_yuugi_03"] = 0},
		[3] = {["thtd_yuugi_01"] = 1,["thtd_yuugi_02"] = 1,["thtd_yuugi_03"] = 0},
		[4] = {["thtd_yuugi_01"] = 1,["thtd_yuugi_02"] = 1,["thtd_yuugi_03"] = 1},
		[5] = {["thtd_yuugi_01"] = 1,["thtd_yuugi_02"] = 1,["thtd_yuugi_03"] = 1},
	},

	["suika"] = {
		[1] = {["thtd_suika_01"] = 1,["thtd_suika_02"] = 1,["thtd_suika_03"] = 0,["thtd_suika_04"] = 0},
		[2] = {["thtd_suika_01"] = 2,["thtd_suika_02"] = 1,["thtd_suika_03"] = 0,["thtd_suika_04"] = 0},
		[3] = {["thtd_suika_01"] = 3,["thtd_suika_02"] = 1,["thtd_suika_03"] = 1,["thtd_suika_04"] = 0},
		[4] = {["thtd_suika_01"] = 4,["thtd_suika_02"] = 1,["thtd_suika_03"] = 1,["thtd_suika_04"] = 1},
		[5] = {["thtd_suika_01"] = 5,["thtd_suika_02"] = 1,["thtd_suika_03"] = 1,["thtd_suika_04"] = 1},
	},

	["junko"] = 
	{		
		[1] = {["thtd_junko_01"] = 1,["thtd_junko_02"] = 1,["thtd_junko_03"] = 0,["thtd_junko_04"] = 0},
		[2] = {["thtd_junko_01"] = 1,["thtd_junko_02"] = 1,["thtd_junko_03"] = 0,["thtd_junko_04"] = 0},
		[3] = {["thtd_junko_01"] = 1,["thtd_junko_02"] = 1,["thtd_junko_03"] = 1,["thtd_junko_04"] = 0},
		[4] = {["thtd_junko_01"] = 1,["thtd_junko_02"] = 1,["thtd_junko_03"] = 1,["thtd_junko_04"] = 0},
		[5] = {["thtd_junko_01"] = 1,["thtd_junko_02"] = 1,["thtd_junko_03"] = 1,["thtd_junko_04"] = 1},
	},

	["hecatia"] = 
	{
		[1] = {["thtd_hecatia_01"] = 1,["thtd_hecatia_02"] = 1,["thtd_hecatia_03"] = 1,["thtd_hecatia_04"] = 1},
		[2] = {["thtd_hecatia_01"] = 1,["thtd_hecatia_02"] = 1,["thtd_hecatia_03"] = 1,["thtd_hecatia_04"] = 1},
		[3] = {["thtd_hecatia_01"] = 1,["thtd_hecatia_02"] = 1,["thtd_hecatia_03"] = 1,["thtd_hecatia_04"] = 1},
		[4] = {["thtd_hecatia_01"] = 1,["thtd_hecatia_02"] = 1,["thtd_hecatia_03"] = 1,["thtd_hecatia_04"] = 1},
		[5] = {["thtd_hecatia_01"] = 1,["thtd_hecatia_02"] = 1,["thtd_hecatia_03"] = 1,["thtd_hecatia_04"] = 1},
	},

	["alice"] = 
	{
		[1] = {["thtd_alice_01"] = 1,["thtd_alice_02"] = 1,["thtd_alice_03"] = 1,["thtd_alice_04"] = 0},
		[2] = {["thtd_alice_01"] = 2,["thtd_alice_02"] = 2,["thtd_alice_03"] = 2,["thtd_alice_04"] = 0},
		[3] = {["thtd_alice_01"] = 3,["thtd_alice_02"] = 3,["thtd_alice_03"] = 3,["thtd_alice_04"] = 0},
		[4] = {["thtd_alice_01"] = 4,["thtd_alice_02"] = 4,["thtd_alice_03"] = 4,["thtd_alice_04"] = 1},
		[5] = {["thtd_alice_01"] = 5,["thtd_alice_02"] = 5,["thtd_alice_03"] = 5,["thtd_alice_04"] = 1},
	},

	["kokoro"] = 
	{
		[1] = {["thtd_kokoro_01"] = 1,["thtd_kokoro_02"] = 1,["thtd_kokoro_03"] = 1,["thtd_kokoro_04"] = 0},
		[2] = {["thtd_kokoro_01"] = 2,["thtd_kokoro_02"] = 2,["thtd_kokoro_03"] = 1,["thtd_kokoro_04"] = 0},
		[3] = {["thtd_kokoro_01"] = 3,["thtd_kokoro_02"] = 3,["thtd_kokoro_03"] = 1,["thtd_kokoro_04"] = 0},
		[4] = {["thtd_kokoro_01"] = 4,["thtd_kokoro_02"] = 4,["thtd_kokoro_03"] = 1,["thtd_kokoro_04"] = 0},
		[5] = {["thtd_kokoro_01"] = 5,["thtd_kokoro_02"] = 5,["thtd_kokoro_03"] = 1,["thtd_kokoro_04"] = 1},
	},

	["hina"] = {
		[1] = {["thtd_hina_01"] = 1,["thtd_hina_02"] = 0},
		[2] = {["thtd_hina_01"] = 2,["thtd_hina_02"] = 0},
		[3] = {["thtd_hina_01"] = 3,["thtd_hina_02"] = 0},
		[4] = {["thtd_hina_01"] = 4,["thtd_hina_02"] = 1},
		[5] = {["thtd_hina_01"] = 5,["thtd_hina_02"] = 1},
	},
}		

thtd_combo_table = 
{
	["letty_cirno"] = {"cirno","letty"},
	["lyrica_lunasa_merlin"] = {"lyrica","lunasa","merlin"},
	["tenshi_iku"] = {"tenshi","iku"},
	["yuyuko_youmu"] = {"youmu","yuyuko"},
	["youmu_reisen"] = {"youmu","reisen"},
	["utsuho_rin"] = {"utsuho","rin"},
	["reimu_marisa"] = {"reimu","marisa"},
	["marisa_alice"] = {"marisa","alice"},
	["koishi_satori"] = {"koishi","satori"},
	["remilia_sakuya"] = {"remilia","sakuya"},
	["remilia_flandre"] = {"remilia","flandre"},
	["meirin_sakuya"] = {"meirin","sakuya"},
	["reimu_yukari"] = {"reimu","yukari"},
	["reimu_alice"] = {"reimu","alice"},	
	["koakuma_patchouli"] = {"koakuma","patchouli"},
	["chen_yukari_ran"] = {"chen","yukari","ran"},
	["eirin_kaguya"] = {"eirin","kaguya"},
	["rumia_reimu"] = {"rumia","reimu"},
	["suwako_kanako_sanae"] = {"suwako","kanako","sanae"},
	["nue_minamitsu"] = {"minamitsu","nue"},
	["futo_soga"] = {"futo","soga"},
	["yoshika_seiga"] = {"yoshika","seiga"},
	["mokou_keine"] = {"mokou","keine"},
	["luna_star_sunny"] = {"luna","star","sunny"},
}

thtd_ability_minoriko_star_up_table = 
{
	[2] = 270,
	[3] = 540,
	[4] = 900,
	[5] = 1260,
}

thtd_ability_sizuha_star_up_table = 
{

	[2] = 216,
	[3] = 432,
	[4] = 720,
	[5] = 1008,
}

thtd_nazrin_star_bouns =
{
	[1] = 0.02,
	[2] = 0.02,
	[3] = 0.02,
	[4] = 0.02,
	[5] = 0.02,
}

thtd_nazrin_star_bouns_constant =
{
	[1] = 2.4,
	[2] = 8.8,
	[3] = 21.6,
	[4] = 43.2,
	[5] = 170.4,
}

thtd_lily_star_bouns =
{
	[1] = 1,
	[2] = 1.8,
	[3] = 2.4,
	[4] = 3.2,
	[5] = 4,
}

thtd_spell_lock  = {
	[0] = {	},
	[1] = {	},
	[2] = {	},
	[3] = {	},
}

THTD_MAX_LEVEL = 10
THTD_MAX_FOOD = 12


function CDOTA_BaseNPC:THTD_InitExp()

	if self:GetUnitName() == "minoriko" or self:GetUnitName() == "sizuha" then

		self.thtd_level = THTD_MAX_LEVEL	
		if GameRules:GetCustomGameDifficulty() == 10 and self:GetUnitName() == "minoriko" then 	
			self.thtd_star = 3
		else
			self.thtd_star = 1
		end
		self.thtd_power = 1
		self.thtd_tower_damage = 0
		self.thtd_is_ex = false
		self.thtd_close_ai = false
		self.thtd_istower = true
		self.thtd_isChanged = false
		self.thtd_exp = thtd_exp_table[THTD_MAX_LEVEL - 1]
		self.thtd_mana_regen = self:GetManaRegen()
		self.thtd_mana_regen_percentage = 0
		self.thtd_crit_chance = 0

		self:THTD_OpenAbility()
		self:THTD_CreateLevelEffect()
		self:SetHasInventory(true)

		self.equip_bonus_table = 
		{
			["attack_percentage"] = 0,
			["mana_regen_percentage"] = 0,
			["crit_chance"] = 0,
			["crit_damage"] = 0,
			["physical_penetration_percentage"] = 0,
			["magical_penetration_percentage"] = 0,
			["power_percentage"] = 0,
			["magical_damage_percentage"] = 0,
			["physical_damage_percentage"] = 0,
			["damage_percentage"] = 0,
			["cooldown"] = 0,
			["attack_speed"] = 0,
			["power"] = 0,
		}

		if GameRules:GetCustomGameDifficulty() == 10 then return end

		local time_count = 0

		self:SetContextThink(DoUniqueString("thtd_minoriko_star_up_listen"), 
			function()
				if GameRules:IsGamePaused() then return 0.03 end
				if self:THTD_IsHidden() then return 1.0 end
				if self == nil or self:IsNull() or self:IsAlive() == false then return nil end
				if SpawnSystem.IsUnLimited then return nil end
				if self.thtd_star < 5 then
					time_count = time_count + 1 * ( (self:FindAbilityByName("ability_common_star_up_speed"):GetLevel() - 1) * 0.1 + 1 )
					if self.thtd_isChanged == true then
						time_count = 0
						self.thtd_isChanged = false
					end
					
					if self:GetUnitName() == "minoriko" then
						SendOverheadEventMessage(self:GetPlayerOwner(), OVERHEAD_ALERT_OUTGOING_DAMAGE, self, thtd_ability_minoriko_star_up_table[self.thtd_star+1] - time_count, self:GetPlayerOwner() )
						if time_count >= thtd_ability_minoriko_star_up_table[self.thtd_star+1] then
							self.thtd_star = self.thtd_star + 1
							self:THTD_OpenAbility()
							self:THTD_DestroyLevelEffect()
							self:THTD_CreateLevelEffect()
							time_count = 0						
							if self.thtd_star == 5 then								
								EmitSoundOnClient(THTD_GetVoiceEvent(self:GetUnitName(),"spawn"),self:GetPlayerOwner())
								CustomGameEventManager:Send_ServerToPlayer(self:GetPlayerOwner() , "show_message", {msg="minoriko_up_to_5_star", duration=30, params={}, color="#ff0"} )
							end
						end
					else
						SendOverheadEventMessage(self:GetPlayerOwner(), OVERHEAD_ALERT_OUTGOING_DAMAGE, self, thtd_ability_sizuha_star_up_table[self.thtd_star+1] - time_count, self:GetPlayerOwner() )
						if time_count >= thtd_ability_sizuha_star_up_table[self.thtd_star+1] then
							self.thtd_star = self.thtd_star + 1
							self:THTD_OpenAbility()
							self:THTD_DestroyLevelEffect()
							self:THTD_CreateLevelEffect()
							time_count = 0							
							if self.thtd_star == 5 then								
								EmitSoundOnClient(THTD_GetVoiceEvent(self:GetUnitName(),"spawn"),self:GetPlayerOwner())
								CustomGameEventManager:Send_ServerToPlayer( self:GetPlayerOwner() , "show_message", {msg="sizuha_up_to_5_star", duration=30, params={}, color="#ff0"} )
							end
						end
					end
					if self:THTD_IsHidden() then
						time_count = 0
					end
				end
				return 1.0
			end, 
		1.0)		

		return
	end


	self.thtd_exp = 0
	self.thtd_level = 1
	self.thtd_star = 1
	self.thtd_tower_damage = 0
	self.thtd_is_ex = false
	self.thtd_close_ai = false
	self.thtd_mana_regen = self:GetManaRegen()
	self.thtd_mana_regen_percentage = 0
	self.thtd_crit_chance = 0

	self.thtd_power = thtd_power_table[self:GetUnitName()][self.thtd_star][1]
	self.thtd_attack = thtd_attack_table[self:GetUnitName()][self.thtd_star][1]
	self.thtd_istower = true
	self:THTD_CreateLevelEffect()
	self:SetHasInventory(true)
	self:THTD_OpenAbility()

	self.equip_bonus_table = 
	{
		["attack_percentage"] = 0,
		["mana_regen_percentage"] = 0,
		["crit_chance"] = 0,
		["crit_damage"] = 0,
		["physical_penetration_percentage"] = 0,
		["magical_penetration_percentage"] = 0,
		["power_percentage"] = 0,
		["magical_damage_percentage"] = 0,
		["physical_damage_percentage"] = 0,
		["damage_percentage"] = 0,
		["cooldown"] = 0,
		["attack_speed"] = 0,
		["power"] = 0,
	}			
end

function CDOTA_BaseNPC:THTD_HeroComboRefresh()
	local hero = THTD_GetHero(self)
    if hero == nil then return end

	for index,tower in pairs(hero.thtd_hero_tower_list) do
		if THTD_IsValid(tower) then
			local combo = THTD_GetCombo(tower)
			local func = tower["THTD_"..tower:GetUnitName().."_thtd_combo"]
			if func then
				local changeCombo = func(tower,combo)
				if changeCombo ~= nil and #changeCombo > 0 then
					for k,v in pairs(changeCombo) do	
						v["unit"] = tower
						local exist = false
						for k2,v2 in pairs(hero.thtd_combo_voice_array) do
							if v2 == v then 
								exist = true
								break
							end
						end
						if exist == false then 
							table.insert(hero.thtd_combo_voice_array, v)
						end							
					end	
					changeCombo = {}									
				end
			end	
		end
	end	

	hero:SetContextThink(DoUniqueString("thtd_combo_voice_array"), 
		function()
			if hero:IsStunned() then return nil end	
			if hero.thtd_combo_voice_array == nil or #hero.thtd_combo_voice_array == 0 then
				hero.sound_lock = nil 
				return nil 
			end

			for k,v in pairs(hero.thtd_combo_voice_array) do
				if v~=nil and v["comboName"] == "lyrica_lunasa_merlin" then
					if v["unit"]~=nil and v["unit"]:IsNull()==false then
						EmitSoundOn(THTD_GetVoiceEvent(v["unit"]:GetUnitName(),"combo."..v["comboName"]),v["unit"])
						table.remove(hero.thtd_combo_voice_array,k)
					end
				elseif v~=nil and hero.sound_lock == nil then
					hero.sound_lock = true
					hero:SetContextThink(DoUniqueString("wait_voice_play_end"), 
						function()							
							hero.sound_lock = false
							return nil
						end,
					v["delay"]+0.5)
				elseif v~=nil and hero.sound_lock == false then
					hero.sound_lock = true
					if v["unit"]~=nil and v["unit"]:IsNull()==false then						
						EmitSoundOn(THTD_GetVoiceEvent(v["unit"]:GetUnitName(),"combo."..v["comboName"]),v["unit"])
					end
					hero:SetContextThink(DoUniqueString("wait_voice_play_end"), 
						function()							
							hero.sound_lock = false
							table.remove(hero.thtd_combo_voice_array,k)
							return nil
						end,
					v["duration"]+0.5)
				end
			end
			return 0.5
		end,
	0)
end

function THTD_GetCombo(tower)
	local comboTable = {}
	for index,value in pairs(thtd_combo_table) do
		local count = 0
		local isInCombo = false

		for k,v in pairs(value) do
			if THTD_IsTowerInList(tower:GetOwner(),v) == true then
				count = count + 1
			end
			if tower:GetUnitName() == v then
				isInCombo = true
			end
		end
		if count == #value and isInCombo == true then
			comboTable[index] = value
		end
	end

	if comboTable ~= nil then
		return comboTable
	end
	return nil
end

function THTD_IsTowerInList(hero,towername)
	for k,v in pairs(hero.thtd_hero_tower_list) do
		if v~=nil and v:IsNull() == false then
			if v:GetUnitName() == towername then
				return true
			end
		end
	end
	return false
end

function CDOTA_BaseNPC:THTD_AddCritChance(chance)
	if self.thtd_crit_chance == nil then return end
	self.thtd_crit_chance = self.thtd_crit_chance + chance
end

local thtd_attack_speed_black_list = 
{
	"nazrin",
	"iku"
}

function CDOTA_BaseNPC:IsInAttackSpeedBlackList()
	for k,v in pairs(thtd_attack_speed_black_list) do
		if self:GetUnitName() == v then
			return true
		end
	end
	return false
end

function CDOTA_BaseNPC:THTD_RefreshAttackSpeed()
	if self == nil or self:IsNull() == false and self:IsAlive() then
		if self:IsInAttackSpeedBlackList() then
			return
		end
		local modifier = self:FindModifierByName("modifier_attack_speed")
		if modifier ~= nil then
			modifier:SetStackCount(self.equip_bonus_table["attack_speed"])
		else
			modifier = self:AddNewModifier(self, nil, "modifier_attack_speed", {})
			modifier:SetStackCount(self.equip_bonus_table["attack_speed"])
		end
	end
end

local thtd_cooldown_black_list = 
{
	"daiyousei",
	"toramaru",
}

function CDOTA_BaseNPC:IsInCooldownBlackList()
	for k,v in pairs(thtd_cooldown_black_list) do
		if self:GetUnitName() == v then
			return true
		end
	end
	return false
end

function CDOTA_BaseNPC:THTD_RefreshCooldown()
	if self == nil or self:IsNull() == false and self:IsAlive() then
		if self:IsInCooldownBlackList() then
			return
		end

		local modifier = self:FindModifierByName("modifier_cooldown_reduce")
		if modifier ~= nil then
			modifier:SetStackCount(self.equip_bonus_table["cooldown"])
		else
			modifier = self:AddNewModifier(self, nil, "modifier_cooldown_reduce", {})
			modifier:SetStackCount(self.equip_bonus_table["cooldown"])
		end
	end
end

local thtd_mana_regen_black_list = 
{
	"lily",
}

function CDOTA_BaseNPC:IsInManaRegenBlackList()
	for k,v in pairs(thtd_mana_regen_black_list) do
		if self:GetUnitName() == v then
			return true
		end
	end
	return false
end

function CDOTA_BaseNPC:THTD_RefreshManaRegen()
	if self:IsInManaRegenBlackList() then
		return
	end
	local totalPercentage = self.equip_bonus_table["mana_regen_percentage"] + self.thtd_mana_regen_percentage

 	if math.abs(self:GetManaRegen() - self.thtd_mana_regen * (1 + totalPercentage/100) ) > 0.1 then
		self:SetBaseManaRegen( self.thtd_mana_regen * (1 + totalPercentage/100) )
	end
end

function CDOTA_BaseNPC:THTD_GetExp()
	return self.thtd_exp
end

function CDOTA_BaseNPC:THTD_AddExp(exp)		
	self.thtd_exp = self.thtd_exp + exp * thtd_exp_star_table[self.thtd_star]
	self:THTD_ExpToLevelUp()
end

function CDOTA_BaseNPC:THTD_ExpToLevelUp()
	if self:THTD_GetLevel() < THTD_MAX_LEVEL then
		if self.thtd_exp >= thtd_exp_table[self.thtd_level] then
			if self.thtd_exp >= thtd_exp_table[THTD_MAX_LEVEL-1] then
				self:THTD_SetLevel(THTD_MAX_LEVEL)
				self.thtd_exp = thtd_exp_table[THTD_MAX_LEVEL-1] + 1
				return
			end
			for i=self.thtd_level,(THTD_MAX_LEVEL-1) do
				if self.thtd_exp < thtd_exp_table[i] then
					self:THTD_SetLevel(i)
					return
				end
			end
		end
	end	
end

function CDOTA_BaseNPC:THTD_SetLevel(level)
	local oldLevel = self.thtd_level
	local upLevel = math.min(level, THTD_MAX_LEVEL) - oldLevel
	self.thtd_level = oldLevel + upLevel

	local unitName = self:GetUnitName()
	if self:THTD_IsTowerEx() == true then
		unitName = unitName.."_ex"
	end

	if thtd_power_table[unitName] ~= nil and thtd_power_table[unitName][self.thtd_star] ~= nil then
		self:THTD_AddPower(thtd_power_table[unitName][self.thtd_star][2] * upLevel)
	end

	if SpawnSystem.IsUnLimited == false and upLevel > 0 and self:HasModifier("modifier_shinki_02_power_up_bonus_buff") then
		if self.thtd_shinki_02_power_up_bonus_count == nil then 
			self.thtd_shinki_02_power_up_bonus_count = (oldLevel - 1) + (self.thtd_star - 1) * (THTD_MAX_LEVEL - 1)
		end
		if self.thtd_shinki_02_power_up_bonus_count < 45 then
			local bonusLevel = math.min(45 - self.thtd_shinki_02_power_up_bonus_count, upLevel)
			if self:GetUnitName() == "shinki" then
				self:THTD_AddPower(5*2*bonusLevel)
			else
				self:THTD_AddPower(self:THTD_GetShinkiMaxStar()*2*bonusLevel)
			end
			self.thtd_shinki_02_power_up_bonus_count = self.thtd_shinki_02_power_up_bonus_count + bonusLevel
		end	
	end

	if thtd_attack_table[unitName]~=nil then
		self:THTD_AddAttack(thtd_attack_table[unitName][self.thtd_star][2]*upLevel)
	end
	local effectIndex = ParticleManager:CreateParticle("particles/econ/events/ti6/hero_levelup_ti6_godray.vpcf", PATTACH_CUSTOMORIGIN, self)
	ParticleManager:SetParticleControl(effectIndex, 0, self:GetOrigin())
	ParticleManager:DestroyParticleSystem(effectIndex,false)

	self:EmitSound("Sound_THTD.thtd_level_up")

	self:THTD_DestroyLevelEffect()
	self:THTD_CreateLevelEffect()
end

function CDOTA_BaseNPC:THTD_LevelUp(level)		
	local oldLevel = self.thtd_level
	local upLevel = math.min(level, THTD_MAX_LEVEL - oldLevel)
	self.thtd_level = oldLevel + upLevel

	local unitName = self:GetUnitName()
	if self:THTD_IsTowerEx() == true then
		unitName = unitName.."_ex"
	end

	if thtd_power_table[unitName] ~= nil and thtd_power_table[unitName][self.thtd_star] ~= nil then
		self:THTD_AddPower(thtd_power_table[unitName][self.thtd_star][2]*upLevel)
	end

	if SpawnSystem.IsUnLimited == false and upLevel > 0 and self:HasModifier("modifier_shinki_02_power_up_bonus_buff") then
		if self.thtd_shinki_02_power_up_bonus_count == nil then 
			self.thtd_shinki_02_power_up_bonus_count = (oldLevel - 1) + (self.thtd_star - 1) * (THTD_MAX_LEVEL - 1)
		end
		if self.thtd_shinki_02_power_up_bonus_count < 45 then
			local bonusLevel = math.min(45 - self.thtd_shinki_02_power_up_bonus_count, upLevel)
			if self:GetUnitName() == "shinki" then
				self:THTD_AddPower(5*2*bonusLevel)
			else
				self:THTD_AddPower(self:THTD_GetShinkiMaxStar()*2*bonusLevel)
			end
			self.thtd_shinki_02_power_up_bonus_count = self.thtd_shinki_02_power_up_bonus_count + bonusLevel
		end	
	end

	if thtd_attack_table[unitName]~=nil then
		self:THTD_AddAttack(thtd_attack_table[unitName][self.thtd_star][2]*upLevel)
	end

	local effectIndex = ParticleManager:CreateParticle("particles/econ/events/ti6/hero_levelup_ti6_godray.vpcf", PATTACH_CUSTOMORIGIN, self)
	ParticleManager:SetParticleControl(effectIndex, 0, self:GetOrigin())
	ParticleManager:DestroyParticleSystem(effectIndex,false)

	self:THTD_DestroyLevelEffect()
	self:THTD_CreateLevelEffect()
end

function CDOTA_BaseNPC:THTD_GetShinkiMaxStar()
	local hero = THTD_GetHero(self)
	if hero == nil then return 0 end
	
	local star = 0
	for k,v in pairs(hero.thtd_hero_tower_list) do
		if v:GetUnitName() == "shinki" then 
			if star < v:THTD_GetStar() then 
				star = v:THTD_GetStar()
			end
		end	
	end
	return star
end

function CDOTA_BaseNPC:THTD_GetLevel()
	return self.thtd_level
end

function CDOTA_BaseNPC:THTD_GetStar()
	return self.thtd_star
end

function CDOTA_BaseNPC:THTD_SetStar(star)
	local lastPower = nil
	local lastAttack = nil

	local unitName = self:GetUnitName()
	if self:THTD_IsTowerEx() == true then
		unitName = unitName.."_ex"
	end

	if thtd_power_table[unitName] ~= nil and thtd_power_table[unitName][self.thtd_star] ~= nil then
		lastPower = thtd_power_table[unitName][self.thtd_star][1] + thtd_power_table[unitName][self.thtd_star][2] * (self:THTD_GetLevel()-1)
	end
	if thtd_attack_table[unitName] ~= nil and thtd_attack_table[unitName][self.thtd_star] ~= nil then
		lastAttack = thtd_attack_table[unitName][self.thtd_star][1] + thtd_attack_table[unitName][self.thtd_star][2] * (self:THTD_GetLevel()-1)
	end

	self.thtd_star = star
	self.thtd_level = 1
	self.thtd_exp = 0

	if thtd_power_table[unitName] ~= nil and thtd_power_table[unitName][self.thtd_star] ~= nil then
		if lastPower~=nil then
			self.thtd_power = self.thtd_power + thtd_power_table[unitName][self.thtd_star][1] - lastPower
		else
			self.thtd_power = self.thtd_power + thtd_power_table[unitName][self.thtd_star][1]
		end
	end

	if thtd_attack_table[unitName] ~= nil and thtd_attack_table[unitName][self.thtd_star] ~= nil then
		if lastAttack~=nil then
			self.thtd_attack = self.thtd_attack + thtd_attack_table[unitName][self.thtd_star][1] - lastAttack
		end
	end

	self:THTD_DestroyLevelEffect()
	self:THTD_CreateLevelEffect()
	self:SetMana(0)
	self:THTD_OpenAbility()
	self:EmitSound("Sound_THTD.thtd_star_up")

	local effectIndex = ParticleManager:CreateParticle("particles/heroes/byakuren/ability_byakuren_02.vpcf", PATTACH_CUSTOMORIGIN, self)
	ParticleManager:SetParticleControl(effectIndex, 0, self:GetOrigin())
	ParticleManager:SetParticleControl(effectIndex, 1, self:GetOrigin())
	ParticleManager:DestroyParticleSystem(effectIndex,false)

	self:THTD_HeroComboRefresh()
end

function CDOTA_BaseNPC:THTD_UpgradeStar()
	local lastPower = nil
	local lastAttack = nil

	local unitName = self:GetUnitName()
	if self:THTD_IsTowerEx() == true then
		unitName = unitName.."_ex"
	end
	
	if thtd_power_table[unitName][self.thtd_star]~=nil then
		lastPower = thtd_power_table[unitName][self.thtd_star][1] + thtd_power_table[unitName][self.thtd_star][2] * (self:THTD_GetLevel()-1)
	end
	if thtd_attack_table[unitName]~=nil then
		lastAttack = thtd_attack_table[unitName][self.thtd_star][1] + thtd_attack_table[unitName][self.thtd_star][2] * (self:THTD_GetLevel()-1)
	end

	self.thtd_star = self.thtd_star + 1
	self.thtd_level = 1
	self.thtd_exp = 0

	if lastPower~=nil then
		self.thtd_power = self.thtd_power + thtd_power_table[unitName][self.thtd_star][1] - lastPower
	else
		self.thtd_power = self.thtd_power + thtd_power_table[unitName][self.thtd_star][1]
	end

	if lastAttack~=nil then
		self.thtd_attack = self.thtd_attack + thtd_attack_table[unitName][self.thtd_star][1] - lastAttack
	end

	self:THTD_DestroyLevelEffect()
	self:THTD_CreateLevelEffect()
	self:SetMana(0)
	self:THTD_OpenAbility()
	self:EmitSound("Sound_THTD.thtd_star_up")

	local effectIndex = ParticleManager:CreateParticle("particles/heroes/byakuren/ability_byakuren_02.vpcf", PATTACH_CUSTOMORIGIN, self)
	ParticleManager:SetParticleControl(effectIndex, 0, self:GetOrigin())
	ParticleManager:SetParticleControl(effectIndex, 1, self:GetOrigin())
	ParticleManager:DestroyParticleSystem(effectIndex,false)

	self:THTD_HeroComboRefresh()
end

	
function CDOTA_BaseNPC:THTD_GetPower()
	if self.thtd_power == nil and self.equip_bonus_table["power"] == nil then return 0 end

	local ability=self:FindAbilityByName("ability_common_power_buff")
	local level = 1

	if ability ~= nil then
		level = ability:GetLevel()
	end
	return math.floor((self.thtd_power + self.equip_bonus_table["power"]) * (1 + ((level - 1) *0.15)) * (1 + self.equip_bonus_table["power_percentage"]/100) + 0.5)
end

function CDOTA_BaseNPC:THTD_AddPower(power)
	self.thtd_power = math.floor(self.thtd_power + power + 0.5)
end

function CDOTA_BaseNPC:THTD_GetAttack()
	if self.thtd_attack == nil or self.equip_bonus_table["attack_percentage"] == nil then return 0 end
	local ability=self:FindAbilityByName("ability_common_power_buff")
	local level = 1

	if ability ~= nil then
		level = ability:GetLevel()
	end
	return math.floor(self.thtd_attack * (1 + ((level - 1) *0.2)) * (1 + self.equip_bonus_table["attack_percentage"]/100) + 0.5)
end

function CDOTA_BaseNPC:THTD_AddAttack(attack)
	self.thtd_attack = math.floor(self.thtd_attack + attack + 0.5)
end


function CDOTA_BaseNPC:THTD_CreateLevelEffect()
	if self.thtd_is_effect_open == true then return end
	self.thtd_level_effect = ParticleManager:CreateParticle("particles/thtd/msg/thtd_msg_level.vpcf", PATTACH_CUSTOMORIGIN, self)
	if self.thtd_level < 10 then
		ParticleManager:SetParticleControl(self.thtd_level_effect, 0, self:GetOrigin())
		ParticleManager:SetParticleControl(self.thtd_level_effect, 2, Vector(0,1,0))
		ParticleManager:SetParticleControl(self.thtd_level_effect, 3, Vector(0,self.thtd_level,0))
	else
		ParticleManager:SetParticleControl(self.thtd_level_effect, 0, self:GetOrigin())
		ParticleManager:SetParticleControl(self.thtd_level_effect, 2, Vector(0,2,0))
		ParticleManager:SetParticleControl(self.thtd_level_effect, 3, Vector(0,10,0))
	end

	self.thtd_star_effect = ParticleManager:CreateParticle("particles/thtd/msg/thtd_msg_star.vpcf", PATTACH_CUSTOMORIGIN, self)

	ParticleManager:SetParticleControl(self.thtd_star_effect, 0, self:GetOrigin())
	ParticleManager:SetParticleControl(self.thtd_star_effect, 2, Vector(0,self.thtd_star,0))
	ParticleManager:SetParticleControl(self.thtd_star_effect, 3, Vector(0,0,0))
	self.thtd_is_effect_open = true
end

function CDOTA_BaseNPC:THTD_DestroyLevelEffect()
	ParticleManager:DestroyParticleSystem(self.thtd_level_effect,true)
	ParticleManager:DestroyParticleSystem(self.thtd_star_effect,true)
	self.thtd_is_effect_open = false
end

local thtd_bonus_ability_table = 
{
	"ability_common_attack_speed_buff",
	"ability_common_power_buff",
	"ability_common_mana_regen_buff",
	"ability_common_decrease_armor_buff",
	"ability_common_decrease_magic_armor_buff",
	"ability_common_star_up_speed",
}

function CDOTA_BaseNPC:THTD_SetAbilityLevelUp()
	for k,v in pairs(thtd_bonus_ability_table) do
		local ability=self:FindAbilityByName(v)

		if ability ~= nil then
			if ability:GetLevel() < ability:GetMaxLevel() then
				ability:SetLevel(ability:GetLevel()+1)
			end
		end
	end
end

function CDOTA_BaseNPC:THTD_OpenAbility()
	local unitName = self:GetUnitName()
	if self:THTD_IsTowerEx() == true then
		unitName = unitName.."_ex"
	end
	for k,v in pairs(thtd_ability_table[unitName]) do
		for abilityName,level in pairs(v) do
			local ability=self:FindAbilityByName(abilityName)
			if self:THTD_GetStar() == k then
				if ability ~= nil and ability:GetLevel()~=level then
					if level < 1 then
						ability:SetActivated(false)						
					else
						ability:SetActivated(true)
					end
					ability:SetLevel(level)
				end
			end
		end
	end
end


function CDOTA_BaseNPC:THTD_IsTower()
	return self.thtd_istower or false
end

function CDOTA_BaseNPC:THTD_UpgradeEx()
	local unitName = self:GetUnitName()
	local star = self:THTD_GetStar()
	local level = self:THTD_GetLevel()

	for k,v in pairs(thtd_ability_table[unitName]) do
		for abilityName,level in pairs(v) do
			if self:THTD_GetStar() == k then
				self:RemoveAbility(abilityName)
			end
		end
	end
	unitName = self:GetUnitName().."_ex"

	for k,v in pairs(thtd_ability_table[unitName]) do
		for abilityName,level in pairs(v) do
			if self:THTD_GetStar() == k then
				local ability=self:AddAbility(abilityName)
				ability:SetLevel(level)
			end
		end
	end

	self:THTD_SetStar(1)
	self:THTD_SetLevel(1)
	self.thtd_is_ex = true
	self:THTD_SetStar(star)
	self:THTD_SetLevel(level)
end

function CDOTA_BaseNPC:THTD_IsTowerEx()
	return self.thtd_is_ex or false
end

function CDOTA_BaseNPC:THTD_GetFaith()
	local hero = self:GetOwner()
	if hero:GetUnitName() ~= "npc_dota_hero_lina" then return 0 end
	if hero.thtd_ss_faith == nil then hero.thtd_ss_faith = 0 end
	if self:HasModifier("modifier_thtd_ss_kill") then
		return hero.thtd_ss_faith
    end
    return 0
end

function CDOTA_BaseNPC:THTD_AddFaith(count)
	local hero = self:GetOwner()
	if hero:GetUnitName() ~= "npc_dota_hero_lina" then return end
	if count < 1 then return end

	if hero.thtd_ss_faith == nil then hero.thtd_ss_faith = 0 end
	local bonusCount = math.min(500-hero.thtd_ss_faith,count)
	hero.thtd_ss_faith = hero.thtd_ss_faith + bonusCount
	for k,v in pairs(hero.thtd_hero_tower_list) do
		if v:HasModifier("modifier_thtd_ss_kill") then
			local modifier = v:FindModifierByName("modifier_thtd_ss_faith")
			if modifier==nil then
				v:AddNewModifier(v, nil, "modifier_thtd_ss_faith", {})
			else
				modifier:SetStackCount(hero.thtd_ss_faith)
			end
		end
	end
end

local thtd_Unique_Slow_Buff = 
{
	"modifier_cirno_01_slow_buff",	
	"modifier_merlin_01_debuff",
	"modifier_satori_01_debuff",
	"modifier_thdots_ran02_debuff",
	"modifier_sanae_debuff",
	"modifier_minamitsu_01_slow_buff",	
	"modifier_yoshika_01_slow",
	"modifier_medicine_01_slow",
	"modifier_star_01_slow",
	"modifier_suika_01_slow_debuff",
	"modifier_hina_01_slow_debuff",
	"modifier_earthshock_debuff_datadriven",
}

function THTD_IsUniqueSlowBuff(modifierName)
	for index,name in pairs(thtd_Unique_Slow_Buff) do
		if name == modifierName then
			return true
		end
	end
	return false
end

function CDOTA_BaseNPC:THTD_HasUniqueSlowBuff()
	local modifiers = self:FindAllModifiers()
	local count = 0

	for k,v in pairs(modifiers) do
		for index,name in pairs(thtd_Unique_Slow_Buff) do
			if v:GetName() == name then
				count = count + 1
			end
		end
	end
	if count > 1 then
		return true
	end
	
	return false
end

function CDOTA_BaseNPC:THTD_IsHidden()
	if self:HasModifier("modifier_touhoutd_release_hidden") then
		return true
	end
	return false
end

local thtd_equip_table = 
{
	["item_2005"] = 
	{
		["single"] = 
		{
			["attack_percentage"] = 10,
		},
		["suit"] = 
		{
			[2] = {
				["attack_percentage"] = 30,
			},
			[4] = {
				["modifier"] = "modifier_item_2005_attack_aura",
			},
		},
	},
	["item_2006"] = 
	{
		["single"] = 
		{
			["mana_regen_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["mana_regen_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2006_mana_regen_aura",
			},
		},
	},
	["item_2007"] = 
	{
		["single"] = 
		{
			["mana_regen_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["mana_regen_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2008_slow_aura",
			},
		},
	},
	["item_2008"] = 
	{
		["single"] = 
		{
			["crit_chance"] = 5,
		},
		["suit"] = 
		{
			[2] = {
				["crit_chance"] = 10,
			},
			[4] = {
				["crit_damage"] = 100,
			},
		},
	},
	["item_2009"] = 
	{
		["single"] = 
		{
			["physical_penetration_percentage"] = 5,
		},
		["suit"] = 
		{
			[2] = {
				["physical_penetration_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2009_physical_penetration",
			},
		},
	},
	["item_2010"] = 
	{
		["single"] = 
		{
			["magical_penetration_percentage"] = 5,
		},
		["suit"] = 
		{
			[2] = {
				["magical_penetration_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2010_magical_penetration",
			},
		},
	},
	["item_2011"] = 
	{
		["single"] = 
		{
			["attack_percentage"] = 10,
			["power_percentage"] = 2,
		},
		["suit"] = 
		{
			[2] = {
				["attack_percentage"] = 15,
				["power_percentage"] = 6,
			},
			[4] = {
				["modifier"] = "modifier_item_2011_attack_stun",
			},
		},
	},
	["item_2012"] = 
	{
		["single"] = 
		{
			["magical_damage_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["magical_damage_percentage"] = 20,
			},
			[4] = {
				["modifier"] = "modifier_item_2012_magical_damage_aura",
			},
		},
	},
	["item_2013"] = 
	{
		["single"] = 
		{
			["physical_damage_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["physical_damage_percentage"] = 20,
			},
			[4] = {
				["modifier"] = "modifier_item_2013_physical_damage_aura",
			},
		},
	},
	["item_2014"] = 
	{
		["single"] = 
		{
			["damage_percentage"] = 3,
		},
		["suit"] = 
		{
			[2] = {
				["damage_percentage"] = 15,
			},
			[4] = {
				["modifier"] = "modifier_item_2014_damage_aura",
			},
		},
	},
	["item_2015"] = 
	{
		["single"] = 
		{
			["crit_chance"] = 5,
		},
		["suit"] = 
		{
			[2] = {
				["crit_chance"] = 10,
			},
			[4] = {
				["crit_chance"] = 25,
			},
		},
	},
	["item_2016"] = 
	{
		["single"] = 
		{
			["magical_damage_percentage"] = 2,
			["mana_regen_percentage"] = 2,
		},
		["suit"] = 
		{
			[2] = {
				["magical_damage_percentage"] = 10,
				["mana_regen_percentage"] = 5,
			},
			[4] = {
				["cooldown"] = 25,
			},
		},
	},
	["item_2017"] = 
	{
		["single"] = 
		{
			["attack_speed"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["attack_speed"] = 20,
			},
			[4] = {
				["attack_speed"] = 25,
			},
		},
	},
	["item_2018"] = 
	{
		["single"] = 
		{
			["attack_percentage"] = 5,
			["power_percentage"] = 2,
		},
		["suit"] = 
		{
			[2] = {
				["attack_percentage"] = 15,
				["power_percentage"] = 6,
			},
			[4] = {
				["modifier"] = "modifier_item_2018_bonus_attack_range",
			},
		},
	},
	["item_2019"] = 
	{
		["single"] = 
		{
			["power_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["power_percentage"] = 12,
			},
			[4] = {
				["power"] = 200,
			},
		},
	},
	["item_2020"] = 
	{
		["single"] = 
		{
			["power_percentage"] = 4,
		},
		["suit"] = 
		{
			[2] = {
				["power_percentage"] = 12,
			},
			[4] = {
				["modifier"] = "modifier_item_2020_damage",
			},
		},
	},
	["item_2025"] = 
	{
		["single"] = 
		{
			["power_percentage"] = 2,
			["magical_damage_percentage"] = 2,
		},
		["suit"] = 
		{
			[2] = {
				["power_percentage"] = 6,
				["magical_damage_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2025_damage",
			},
		},
	},
	["item_2026"] = 
	{
		["single"] = 
		{
			["power_percentage"] = 2,
			["physical_damage_percentage"] = 2,
		},
		["suit"] = 
		{
			[2] = {
				["power_percentage"] = 6,
				["physical_damage_percentage"] = 10,
			},
			[4] = {
				["modifier"] = "modifier_item_2026_damage",
			},
		},
	},
}

function CDOTA_BaseNPC:THTD_GetSelfItemCount(itemName)
	local count = 0
 	for i=0,5 do
		local targetItem = self:GetItemInSlot(i)
		if targetItem~=nil and targetItem:IsNull()==false then
			if targetItem:GetAbilityName() == itemName then
				count = count + 1
			end
		end
	end
	return count
end

function CDOTA_BaseNPC:THTD_EquipRefresh()
	local equip_bonus_table = 
	{
		["attack_percentage"] = 0,
		["mana_regen_percentage"] = 0,
		["crit_chance"] = 0,
		["crit_damage"] = 0,
		["physical_penetration_percentage"] = 0,
		["magical_penetration_percentage"] = 0,
		["power_percentage"] = 0,
		["magical_damage_percentage"] = 0,
		["physical_damage_percentage"] = 0,
		["damage_percentage"] = 0,
		["cooldown"] = 0,
		["attack_speed"] = 0,
		["power"] = 0,
	}

	local suitUnique = {}

 	for i=0,5 do
		local targetItem = self:GetItemInSlot(i)

		if targetItem~=nil and targetItem:IsNull()==false then
			for itemName,value in pairs(thtd_equip_table) do
				if targetItem:GetAbilityName() == itemName then
					if value["single"] ~= nil then
						for bonusName,bonus in pairs(value["single"]) do
							equip_bonus_table[bonusName] = equip_bonus_table[bonusName] + bonus
						end
					end


					if value["suit"] ~= nil and suitUnique[itemName] ~= true then
						suitUnique[itemName] = true

						if self:THTD_GetSelfItemCount(itemName) >= 2 then
							for bonusName,bonus in pairs(value["suit"][2]) do
								if bonusName ~= "modifier" then
									equip_bonus_table[bonusName] = equip_bonus_table[bonusName] + bonus
								else
									if self:HasModifier(bonus) == false then
										local modifier = self:AddNewModifier(self, nil, bonus, {})
										self:SetContextThink(DoUniqueString("thtd_remove_modifier"), 
											function()
												if GameRules:IsGamePaused() then return 0.03 end
												if self:THTD_GetSelfItemCount(itemName) < 2 then
													modifier:Destroy()
													return nil
												end
												return 1.0
											end,
										1.0)
									end
								end
							end
						end

						if self:THTD_GetSelfItemCount(itemName) >= 4 then
							for bonusName,bonus in pairs(value["suit"][4]) do
								if bonusName ~= "modifier" then
									equip_bonus_table[bonusName] = equip_bonus_table[bonusName] + bonus
								else
									if self:HasModifier(bonus) == false then
										self:AddNewModifier(self, nil, bonus, {})
										local modifier = self:AddNewModifier(self, nil, bonus, {})
										self:SetContextThink(DoUniqueString("thtd_remove_modifier"), 
											function()
												if GameRules:IsGamePaused() then return 0.03 end
												if self:THTD_GetSelfItemCount(itemName) < 4 then
													modifier:Destroy()
													return nil
												end
												return 1.0
											end,
										1.0)
									end
								end
							end
						end
					end


				end
			end
		end
	end

	for k,v in pairs(equip_bonus_table) do
		self.equip_bonus_table[k] = v
	end	

	equip_bonus_table = {}
	suitUnique = {}
	
	self:THTD_RefreshManaRegen()
	self:THTD_RefreshCooldown()
	self:THTD_RefreshAttackSpeed()
end

function CDOTA_BaseNPC:THTD_DropItemAll()
	for i=0,8 do
		local targetItem = self:GetItemInSlot(i)
		if targetItem~=nil and targetItem:IsNull()==false then				
			if self:GetUnitName() == "chen" or self:GetUnitName() == "aya" then									
				self:DropItemAtPositionImmediate(targetItem, self:GetOwner():GetOrigin())				
			else
				self:DropItemAtPositionImmediate(targetItem, self:GetOrigin())
			end				
		end
	end
end

function CDOTA_BaseNPC:THTD_AddCardPoolItem(itemName)
	if self:GetUnitName()~="npc_dota_hero_lina" or itemName==nil then return end

	local item = CreateItem(itemName, nil, nil)
	if item==nil then return end	
	item.card_poor_player_id = self.thtd_player_id
	item.owner_player_id = self.thtd_player_id
	self:AddItem(item)
	item:THTD_RemoveItemInList(self.thtd_player_id)				

	local cardName = item:THTD_GetCardName()
	if item:THTD_IsCardHasVoice() == true then
		local player = self:GetPlayerOwner()
		if player then
			EmitSoundOnClient(THTD_GetVoiceEvent(cardName,"spawn"),player)
		end
	end

	if item:THTD_IsCardHasPortrait() == true then
		local portraits= item:THTD_GetPortraitPath(cardName)
		local quality = item:THTD_GetCardQuality()
		if quality == 1 then
			local effectIndex = ParticleManager:CreateParticleForPlayer(portraits, PATTACH_WORLDORIGIN, self, self:GetPlayerOwner())
			ParticleManager:SetParticleControl(effectIndex, 0, Vector(-58,-80,0))
			ParticleManager:SetParticleControl(effectIndex, 1, Vector(80,0,0))
			ParticleManager:DestroyParticleSystemTime(effectIndex,6.0)
			self:EmitSound("Sound_THTD.thtd_draw_n")
		elseif quality == 2 then
			local effectIndex = ParticleManager:CreateParticleForPlayer(portraits, PATTACH_WORLDORIGIN, self, self:GetPlayerOwner())
			ParticleManager:SetParticleControl(effectIndex, 0, Vector(-58,-80,0))
			ParticleManager:SetParticleControl(effectIndex, 1, Vector(80,0,0))
			ParticleManager:DestroyParticleSystemTime(effectIndex,6.0)
			self:EmitSound("Sound_THTD.thtd_draw_r")
		elseif quality == 3 then
			local effectIndex = ParticleManager:CreateParticleForPlayer(portraits, PATTACH_WORLDORIGIN, self, self:GetPlayerOwner())
			ParticleManager:SetParticleControl(effectIndex, 0, Vector(-58,-80,0))
			ParticleManager:SetParticleControl(effectIndex, 1, Vector(80,0,0))
			ParticleManager:DestroyParticleSystemTime(effectIndex,6.0)
			self:EmitSound("Sound_THTD.thtd_draw_sr")
		elseif quality == 4 then
			local effectIndex = ParticleManager:CreateParticle(portraits, PATTACH_WORLDORIGIN, nil)
			ParticleManager:SetParticleControl(effectIndex, 0, Vector(-58,-80,0))
			ParticleManager:SetParticleControl(effectIndex, 1, Vector(80,0,0))
			ParticleManager:DestroyParticleSystemTime(effectIndex,6.0)
			effectIndex = ParticleManager:CreateParticle("particles/portraits/portraits_ssr_get_screen_effect.vpcf", PATTACH_WORLDORIGIN, nil)
			ParticleManager:DestroyParticleSystemTime(effectIndex,4.0)
			self:EmitSound("Sound_THTD.thtd_draw_ssr")
		end		
	end

end

local thtd_remain_buff = 
{
	"modifier_miko_02_buff",	
	"modifier_byakuren_03_buff",
	"modifier_thtd_ss_kill",
	"modifier_sanae_04_buff",
	"modifier_thtd_ss_faith",
	"modifier_sakuya_02_buff",
	"modifier_suwako_04_buff",
	"modifier_yuuka_03_kill_count",
}

function THTD_IsRemainBuff(modifierName)
	for index,name in pairs(thtd_remain_buff) do
		if name == modifierName then
			return true
		end
	end
	return false
end

function THTD_SetSpellLock(caster, abilityName, time)
	local id = caster:GetPlayerOwnerID()
	if thtd_spell_lock[id] == nil then thtd_spell_lock[id] = {} end
	thtd_spell_lock[id][abilityName] = GameRules:GetGameTime() + time  -- 有时实际时间要加一个AI运行间隔
	-- ability:GetCastPoint() --施法前摇
end

function THTD_IsSpellLock(caster, abilityName)	
	local id = caster:GetPlayerOwnerID()
	if thtd_spell_lock[id] == nil then thtd_spell_lock[id] = {} end
	if thtd_spell_lock[id][abilityName] ~= nil and thtd_spell_lock[id][abilityName] > GameRules:GetGameTime() then			
		return true
	else		
		return false
	end	
end

